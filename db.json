{
    "modules": [{
        "name": "linux/network",
        "questions": [{
            "question": "List all udp connections on this machine.",
            "answer": "netstat -lanu"
        }, {
            "question": "List all TCP connections on this machine.",
            "answer": "netstat -lant"
        }, {
            "question": "How do you list all established connections?",
            "answer": "lsof -i"
        }, {
            "question": "How do you access a Windows SMB share at 192.168.0.1?",
            "answer": "smb://192.168.0.1/share"
        }, {
            "question": "How do you do a domain lookup for ip 1.2.3.4 using host?",
            "answer": "host 1.2.3.4"
        }, {
            "question": "How do you turn on IP forwarding on a Linux box?",
            "answer": "echo \"1\" > /proc/sys/net/ipv4/ip_forward"
        }, {
            "question": "How do you do a DNS Zone transfer for IP 1.2.3.4 and domain site.com?",
            "answer": "dig @1.2.3.4 site.com -t AXFR"
        }, {
            "question": "Add DNS Server 8.8.8.8 to a Linux host?",
            "answer": "echo \"nameserver 8.8.8.8\" > /etc/resolv.conf"
        }, {
            "question": "Mount a Windows share at 1.2.3.4 on Linux?",
            "answer": "share user 1.2.3.4 c$"
        }, {
            "question": "Set the default gateway on a linux box to 1.2.3.4 ?",
            "answer": "route add default gw 1.2.3.4"
        }, {
            "question": "Block the evil IP address 6.6.6.6 on port 8080 on a linux machine.",
            "answer": "tcpkill host 6.6.6.6 and port 8080"
        }],
        "commands": [{
            "command": "watch ss -tp",
            "comment": "Network connections"
        }, {
            "command": "netstat -lant",
            "comment": "Tcp connections (-lanu = udp)"
        }, {
            "command": "lsof -i",
            "comment": "Established connections"
        }, {
            "command": "smb://<IP>/share",
            "comment": "Access windows SMB share"
        }, {
            "command": "share user x.x.x.x c$",
            "comment": "Mount Windows Share"
        }, {
            "command": "smbclient -U user \\\\\\\\<IP>\\\\<SHARE>",
            "comment": "SMB connect"
        }, {
            "command": "ifconfig eth# <IP>/<CIDR>",
            "comment": "Set IP and netmask"
        }, {
            "command": "ifconfig eth0:1 <IP>/<CIDR>",
            "comment": "Set Virtual Interface"
        }, {
            "command": "route add default gw <GW_IP>",
            "comment": "Set Gateway"
        }, {
            "command": "ifconfig eth# mtu [SIZE]",
            "comment": "Change MTU size"
        }, {
            "command": "export MAC=xx.xx.xx.xx.xx.xx",
            "comment": "Change MAC"
        }, {
            "command": "ifconfig <INT> hw ether <MAC>",
            "comment": "Change MAC"
        }, {
            "command": "macchanger -m <MAC> <INT>",
            "comment": "Kali MAC changer"
        }, {
            "command": "iwlist <INT> scan",
            "comment": "Built-in Wifi Scanner"
        }, {
            "command": "dig -x <IP>",
            "comment": "Domain lookup for IP"
        }, {
            "command": "host <IP>",
            "comment": "Domain lookup for IP"
        }, {
            "command": "host -t SRV _<SERVICE>_tcp.url.com",
            "comment": "Domain SRV lookup"
        }, {
            "command": "dig @<IP> domain -t AXFR",
            "comment": "DNS Zone Xfer"
        }, {
            "command": "host -l <DOMAIN> <NAMESVR>",
            "comment": "DNS Zone Xfer"
        }, {
            "command": "ip xfrm state list",
            "comment": "Print existing VPN keys"
        }, {
            "command": "ip addr add <IP>/<CIDR> dev eth0",
            "comment": "Adds 'hidden' interface"
        }, {
            "command": "/var/log/messages |grep DHCP",
            "comment": "List DHCP assignments"
        }, {
            "command": "tcpkill host <IP> and port <PORT>",
            "comment": "Block ip:port"
        }, {
            "command": "echo \"1\" > /proc/sys/net/ipv4/ip_forward",
            "comment": "Turn on IP forwarding"
        }, {
            "command": "echo \"nameserver x.x.x.x\" > /etc/resolve.conf",
            "comment": "Add DNS server"
        }],
        "tags": [{
            "tag": "networking",
            "none": "non"
        }, {
            "tag": "linux",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/system_info",
        "questions": [{
            "question": "How do you find the hostname for IP 1.2.3.4 using nbtstat/nmblookup?",
            "answer": "nmblookup -A 1.2.3.4"
        }, {
            "question": "List the current username in linux.",
            "answer": "id"
        }, {
            "question": "List logged on users.",
            "answer": "w"
        }, {
            "question": "How do you list mounted file systems on a Linux box?",
            "answer": "mount"
        }, {
            "question": "How do you show a list of users on the on a Linux box?",
            "answer": "getent passwd"
        }, {
            "question": "How would you add path /home/mypath to the PATH variable?",
            "answer": "PATH=$PATH:/home/mypath"
        }, {
            "question": "How do you list installed packages on Ubuntu?",
            "answer": "dpkg -get-selections"
        }],
        "commands": [{
            "command": "nmblookup -A <IP>",
            "comment": "Get host name for <IP>"
        }, {
            "command": "id",
            "comment": "Current Username"
        }, {
            "command": "w",
            "comment": "Logged on users"
        }, {
            "command": "who -a",
            "comment": "User information"
        }, {
            "command": "last -a",
            "comment": "Last users logged on"
        }, {
            "command": "ps -ef",
            "comment": "Process Listing (top)"
        }, {
            "command": "df -h",
            "comment": "Disk Usage (free)"
        }, {
            "command": "uname -a",
            "comment": "Kernel version/CPU info"
        }, {
            "command": "mount",
            "comment": "Mounted file systems"
        }, {
            "command": "getent passwd",
            "comment": "Show list of users"
        }, {
            "command": "PATH=$PATH:/home/mypath",
            "comment": "Add to PATH variable"
        }, {
            "command": "kill <pid>",
            "comment": "Kill a process by id"
        }, {
            "command": "cat /etc/issue",
            "comment": "Show OS info"
        }, {
            "command": "cat /etc/*release*",
            "comment": "Show OS version info"
        }, {
            "command": "cat /proc/version",
            "comment": "Show kernel info"
        }, {
            "command": "dpkg -get-selections",
            "comment": "Installed Packages (Ubuntu)"
        }, {
            "command": "dpkg -I *.deb",
            "comment": "Installed DEB (-r=remove)"
        }, {
            "command": "which",
            "comment": "Show location of executable"
        }],
        "tags": [{
            "tag": "linux",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/utility",
        "questions": [{
            "question": "Grab the URL site.com using wget on linux and save to a file called url.txt",
            "answer": "wget http://site.com -O url.txt -o /dev/null"
        }, {
            "question": "Connect to 1.2.3.4 via remote desktop on Linux.",
            "answer": "rdesktop 1.2.3.4"
        }, {
            "question": "Add a user named frank on a Linux machine.",
            "answer": "useradd -m frank"
        }, {
            "question": "How do you changes user frank's password on Linux?",
            "answer": "passwd frank"
        }, {
            "question": "How do you remove user frank from Linux?",
            "answer": "rmuser frank"
        }, {
            "question": "How do you record the shell session to file ~/outfile.txt in linux?",
            "answer": "script -a ~/outfile.txt"
        }, {
            "question": "Execute line 72 in history in Linux.",
            "answer": "!72"
        }],
        "commands": [{
            "command": "wget http://<url> -O url.txt -o /dev/null",
            "comment": "Grab URL"
        }, {
            "command": "rdesktop <IP>",
            "comment": "Remote Desktop to <IP>"
        }, {
            "command": "useradd -m <user>",
            "comment": "Add User"
        }, {
            "command": "passwd <user>",
            "comment": "Change user password"
        }, {
            "command": "rmuser <uname>",
            "comment": "Remove user"
        }, {
            "command": "script -a <outfile>",
            "comment": "Record shell : Ctrl-D stops"
        }, {
            "command": "history",
            "comment": "View users command history"
        }, {
            "command": "!<num>",
            "comment": "Executes line # in history"
        }],
        "tags": [{
            "tag": "linux",
            "none": ""
        }, {
            "tag": "utility",
            "none": "add tag basics"
        }, {
            "tag": "basics",
            "none": ""
        }, {
            "tag": "linux",
            "none": "adsf"
        }],
        "platform": ""
    }, {
        "name": "linux/file",
        "questions": [{
            "question": "How would you diff the files file1.txt and file2.txt?",
            "answer": "diff file1.txt file2.txt"
        }, {
            "question": "How would you create a file called newfile.txt that would have the timestamp of the file oldfile.txt?",
            "answer": "touch -r oldfile.txt newfile.txt"
        }, {
            "question": "Change the file file.txt to have timestamp of Oct, 22. 2017 at 06:22 am?",
            "answer": "touch -t 201710220622 file.txt"
        }],
        "commands": [{
            "command": "diff file1 file2",
            "comment": "Compare Files"
        }, {
            "command": "rm -rf <dir>",
            "comment": "Force delete <dir>"
        }, {
            "command": "shred -f -u <file>",
            "comment": "Overwrite/delete file"
        }, {
            "command": "touch -r <ref_file> <file>",
            "comment": "Matches ref_file timestamp"
        }, {
            "command": "touch -t YYYYMMDDHHSS <file>",
            "comment": "Set file timestamp"
        }],
        "tags": [{
            "tag": "linux",
            "none": "asdf"
        }, {
            "tag": "file",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/misc",
        "questions": [{
            "question": "How to disable history logging on a linux machine?",
            "answer": "unset HISTFILE"
        }, {
            "question": "How would you compile a file called file.c to a file called outfile using gcc?",
            "answer": "gcc -o outfile file.c"
        }, {
            "question": "How would you make a random 3MB file in linux called newfile?",
            "answer": "dd if=/dev/urandom of=newfile bs=3145728 count=100"
        }],
        "commands": [{
            "command": "unset HISTFILE",
            "comment": "Disable history logging"
        }, {
            "command": "gcc -o outfile myfile.c",
            "comment": "Compile C,C++ with gcc"
        }, {
            "command": "grep 'href=' <FILE> |cut -d\"/\" -f3 |grep <URL> |sort -u",
            "comment": "Strip links in url.com"
        }, {
            "command": "dd if=/dev/urandom of=<FILE> bs=3145728 count=100",
            "comment": "Make random 3MB file"
        }],
        "tags": [{
            "tag": "linux",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/cover_tracks",
        "questions": [{
            "question": "How would you clear the auth.log file on a Linux Box?",
            "answer": "echo \"\" > /var/log/auth.log"
        }, {
            "question": "How would you clear the current user bash history in Linux?",
            "answer": "echo \"\" > ~/.bash_history"
        }, {
            "question": "How would you clear session history in Linux?",
            "answer": "history -c"
        }, {
            "question": "How would you disable history logging in linux?",
            "answer": "unset HISTFILE"
        }],
        "commands": [{
            "command": "echo \"\" > /var/log/auth.log",
            "comment": "Clear auth.log file"
        }, {
            "command": "echo \"\" > ~/.bash_history",
            "comment": "Clear current user bash history"
        }, {
            "command": "rm -rf ~/.bash_history",
            "comment": "Delete bash history file"
        }, {
            "command": "history -c",
            "comment": "Clear current session history"
        }, {
            "command": "export HISTFILESIZE=0",
            "comment": "Set history max lines to zero"
        }, {
            "command": "export HISTSIZE=0",
            "comment": "Set history max commands to 0"
        }, {
            "command": "unset HISTFILE",
            "comment": "Disable history logging (need to logout to take effect)"
        }],
        "tags": [{
            "tag": "linux",
            "none": "asdf"
        }, {
            "tag": "hacking",
            "none": "asdf"
        }, {
            "tag": "pentest",
            "none": "asdf"
        }, {
            "tag": "hiding",
            "none": "asdf"
        }, {
            "tag": "persistence",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/hack_scripting",
        "questions": [{
            "question": "How would you fork bomb linux?",
            "answer": ":(){:|: &};:"
        }, {
            "question": "How would one do a ping sweep for the 192.168.0.1/24 network?",
            "answer": "for x in {1..254..1};do ping -c 192.168.0.$x"
        }],
        "commands": [{
            "command": ":(){:|: &};:",
            "comment": "Fork Bomb"
        }, {
            "command": "for x in {1..254..1};do ping -c 1.1.1.$x",
            "comment": "Ping Sweep"
        }],
        "tags": [{
            "tag": "linux",
            "none": "adsf"
        }, {
            "tag": "hacking",
            "none": "asdf"
        }, {
            "tag": "script",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "linux/iptables",
        "questions": [{
            "question": "How would you dump iptables rules to a file called newfile?",
            "answer": "iptables-save -c > newfile"
        }, {
            "question": "How would you restore iptables rules from file newfile?",
            "answer": "iptables-restore newfile"
        }, {
            "question": "How would you flush all iptables rules?",
            "answer": "iptables -F"
        }, {
            "question": "How would you delete the 7th inbound rule in iptables?",
            "answer": "iptables -D INPUT 7"
        }, {
            "question": "How would you drop all packets in iptables?",
            "answer": "iptables -P INPUT DROP"
        }],
        "commands": [{
            "command": "iptables-save -c > <FILE>",
            "comment": "Dump iptables (with counters) rules to stdout"
        }, {
            "command": "iptables-restore <FILE>",
            "comment": "Restore iptables rules"
        }, {
            "command": "iptables -L -v --line-numbers",
            "comment": "List all iptables rules with affected and line numbers"
        }, {
            "command": "iptables -F",
            "comment": "Flush all iptables rules"
        }, {
            "command": "iptables -P <INPUT/FORWARD/OUTPUT> <ACCEPT/REJECT/DROP>",
            "comment": "Change default policy for rules that don't match rules"
        }, {
            "command": "iptables -D INPUT 7",
            "comment": "Delete 7th Inbound rule"
        }, {
            "command": "iptables -t raw -L -n",
            "comment": "Increase throughput by turning off statefulness"
        }, {
            "command": "iptables -P INPUT DROP",
            "comment": "Drop all packets"
        }, {
            "command": "iptables -A INPUT -i <interface> -m state --state RELATED,ESTABLISHED -j ACCEPT",
            "comment": "Allow established connections on INPUT"
        }, {
            "command": "iptables -A OUTPUT -o <iface> -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT",
            "comment": "Establish outbound rule for ssh on port 22 in iptables"
        }, {
            "command": "iptable -A INPUT -i <iface> -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT",
            "comment": "Establish inbound connection for outbound ssh on port 22 in iptables"
        }],
        "tags": [{
            "tag": "linux",
            "none": "asdf"
        }, {
            "tag": "firewall",
            "none": "asdf"
        }, {
            "tag": "iptables",
            "none": "asdf"
        }, {
            "tag": "pivoting",
            "none": "asdf"
        }],
        "platform": ""
    }, {
        "name": "networking/tcpdump",
        "questions": [{
            "question": "How do you capture only 7 packets from device eth0?",
            "answer": "tcpdump -c 7 -i eth0"
        }, {
            "question": "How do you capture traffic from device eth0 in ASCII and HEX, using tcpdump?",
            "answer": "tcpdump -XX -i eth0"
        }, {
            "question": "How do you read the pcap file file.pcap using tcpdump?",
            "answer": "tcpdump -r file.pcap"
        }, {
            "question": "How do you write a packet capture to a file called file.pcap, listening on device eth0, using tcpdump?",
            "answer": "tcpdump -w file.pcap -i eth0"
        }, {
            "question": "How do you capture only IP packets on eth0 using tcpdump?",
            "answer": "tcpdump -n -i eth0"
        }, {
            "question": "How would you capture only tcp packets on eth0 using tcpdump?",
            "answer": "tcpdump -i eth0 tcp"
        }],
        "commands": [{
            "command": "tcpdump -i eth0",
            "comment": "Listen to all packets on device eth0"
        }, {
            "command": "tcpdump -c 5 -i eth0",
            "comment": "Capture 5 packets from device eth0"
        }, {
            "command": "tcpdump -A -i eth0",
            "comment": "Listen to all packets from eth0 and print as ASCII"
        }, {
            "command": "tcpdump -D",
            "comment": "Display available interfaces"
        }, {
            "command": "tcpdump -XX -i eth0",
            "comment": "Display all packets in HEX and ASCII"
        }, {
            "command": "tcpdump -w file.pcap -i eth0",
            "comment": "Write all captured packets to a file"
        }, {
            "command": "tcpdump -r savedcap.pcap",
            "comment": "Read captured packets file"
        }, {
            "command": "tcpdump -n -i eth0",
            "comment": "Capture IP address packets"
        }, {
            "command": "tcpdump -i eth0 tcp",
            "comment": "Capture only tcp packets"
        }, {
            "command": "tcpdump -i eth0 port 22",
            "comment": "Capture packets from only port 22"
        }, {
            "command": "tcpdump -i eth0 src 1.2.3.4",
            "comment": "Capture packets from source IP 1.2.3.4"
        }],
        "tags": [],
        "platform": ""
    }, {
        "name": "windows/cmd/system_info",
        "questions": [{
            "question": "How do you get the windows OS version in CMD?",
            "answer": "ver"
        }, {
            "question": "List all Windows services in CMD terminal.",
            "answer": "sc query state=all"
        }, {
            "question": "How do you list Windows processes and services using CMD?",
            "answer": "tasklist /svc"
        }, {
            "question": "How do you list Windows prcesses and DLLs using CMD?",
            "answer": "tasklist /m"
        }, {
            "question": "How would you search the Windows registry for passwords?",
            "answer": "reg query HKLM /f password /t REG_SZ /s"
        }, {
            "question": "How would you list Windows Drives using CMD?",
            "answer": "fsutil fsinfo drives"
        }, {
            "question": "Search a Windows machine for pdf files using CMD?",
            "answer": "dir /a /s /b c:\\*.pdf*"
        }, {
            "question": "How would you search for passwords on a windows machine in files of a specific type?",
            "answer": "findstr /si password *.txt| *.xls"
        }, {
            "question": "Save Windows security hive to file.",
            "answer": "reg save HKLM\\Security security.hive"
        }, {
            "question": "Print current user in Windows using CMD",
            "answer": "echo %USERNAME%"
        }],
        "commands": [{
            "command": "ver",
            "comment": "Get OS Version"
        }, {
            "command": "sc query state=all",
            "comment": "Get services"
        }, {
            "command": "tasklist /svc",
            "comment": "Show processes and services"
        }, {
            "command": "tasklist /m",
            "comment": "Show all processes and DLLs"
        }, {
            "command": "tasklist /S <IP> /v",
            "comment": "Remote process listing for IP"
        }, {
            "command": "taskkill /PID <PID> /F",
            "comment": "Kill a PID"
        }, {
            "command": "systeminfo /S <IP> /U domain\\user /P <pwd>",
            "comment": "Remote Sytem info"
        }, {
            "command": "req query \\\\<IP>\\<RegDomain>\\<Key> /v",
            "comment": "Query remote registry"
        }, {
            "command": "reg query HKLM /f password /t REG_SZ /s",
            "comment": "Search registry for passwords"
        }, {
            "command": "fsutil fsinfo drives",
            "comment": "List drives \"must be admin\""
        }, {
            "command": "dir /a /s /b c:\\*.pdf*",
            "comment": "Search for all pdfs"
        }, {
            "command": "findstr /si password *.txt| *.xml| *.xls",
            "comment": "Searches for password in specific file types"
        }, {
            "command": "reg save HKLM\\Security security.hive",
            "comment": "Save security hive to file"
        }, {
            "command": "echo %USERNAME%",
            "comment": "Current user"
        }],
        "tags": [],
        "platform": ""
    }, {
        "name": "windows/cmd/net_domain",
        "questions": [{
            "question": "How would you list Hosts in a current domain in Windows via CMD?",
            "answer": "net view /domain"
        }, {
            "question": "List the hosts in MYDOMAIN in Windows via CMD.",
            "answer": "net view /domain:MYDOMAIN"
        }, {
            "question": "How do you list all users in a domain in Windows via CMD?",
            "answer": "net user /domain"
        }, {
            "question": "How do you add user frank with password 'password' to a Windows account via CMD?",
            "answer": "net user frank password /add"
        }, {
            "question": "How do you add user frank to the local Admin group on a Windows box via CMD?",
            "answer": "net localgroup \"Administrators\" frank /add"
        }, {
            "question": "List the domain password policy in Windows via CMD.",
            "answer": "net accounts /domain"
        }, {
            "question": "List the local Windows Adminstrators group in CMD.",
            "answer": "net localgroup \"Administrators\""
        }, {
            "question": "How do you list the domain groups in Windows via CMD?",
            "answer": "net group /domain"
        }, {
            "question": "How do you list users in \"Domain Admins\" group on a Windows domain via CMD?",
            "answer": "net group \"Domain Admins\" /domain"
        }, {
            "question": "List current SMB shares in Windows via CMD.",
            "answer": "net share"
        }, {
            "question": "How would you chage domain user frank's password in Windows to 'password' via CMD?",
            "answer": "net user frank \"password\" /domain"
        }, {
            "question": "How would you unlock domain user frank's account in Windows using CMD?",
            "answer": "net user frank /ACTIVE:yes /domain"
        }],
        "commands": [{
            "command": "net view /domain",
            "comment": "Hosts in current domain"
        }, {
            "command": "net view /domain:[MYDOMAIN]",
            "comment": "Hosts in [MYDOMAIN]"
        }, {
            "command": "net user /domain",
            "comment": "All users in current domain"
        }, {
            "command": "net user <user> <pass> /add",
            "comment": "Add user"
        }, {
            "command": "net localgroup \"Administrators\" <user> /add",
            "comment": "Add user to local administrators"
        }, {
            "command": "net accounts /domain",
            "comment": "Domain password policy"
        }, {
            "command": "net localgroup \"Administrators\"",
            "comment": "Local admins"
        }, {
            "command": "net group /domain",
            "comment": "List domain groups"
        }, {
            "command": "net group \"Domain Admins\" /domain",
            "comment": "List users in Domain Admins"
        }, {
            "command": "net group \"Domain Controllers\" /domain",
            "comment": "List DCs for current domain"
        }, {
            "command": "net share",
            "comment": "List current SMB shares"
        }, {
            "command": "net user <user> \"<newpassword>\" /domain",
            "comment": "Change domain user password"
        }, {
            "command": "net user <user> /ACTIVE:yes /domain",
            "comment": "Unlock domain user account"
        }, {
            "command": "net share <share> C:\\share /GRANT:Everyone,FULL",
            "comment": "Share folder"
        }],
        "tags": [{
            "tag": "windows",
            "none": "asdf"
        }, {
            "tag": "domain",
            "none": "asdf"
        }],
        "platform": ""
    }]
}